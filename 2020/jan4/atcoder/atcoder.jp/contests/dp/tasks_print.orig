







<!DOCTYPE html>
<html>
<head>
	<title>Educational DP Contest</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Language" content="en">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="google-site-verification" content="nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM" />

	
	<meta name="description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online.">
	<meta name="author" content="AtCoder Inc.">

	<meta property="og:site_name" content="AtCoder">
	
	<meta property="og:title" content="Educational DP Contest" />
	<meta property="og:description" content="AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online." />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://atcoder.jp/contests/dp/tasks_print" />
	<meta property="og:image" content="https://img.atcoder.jp/assets/atcoder.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@atcoder" />
	
	<meta property="twitter:title" content="Educational DP Contest" />

	<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="/public/css/bootstrap.min.css?v=202001082219">
	<link rel="stylesheet" type="text/css" href="/public/css/base.css?v=202001082219">
	<link rel="shortcut icon" type="image/png" href="//img.atcoder.jp/assets/favicon.png">
	<link rel="apple-touch-icon" href="//img.atcoder.jp/assets/atcoder.png">
	<script src="/public/js/lib/jquery-1.9.1.min.js?v=202001082219"></script>
	<script src="/public/js/lib/bootstrap.min.js?v=202001082219"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.4/js.cookie.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/locale/ja.js"></script>
	<script>
		var LANG = "en";
		var userScreenName = "";
		var csrfToken = "gIStXCUVNaXNFe0BRIdLuLl88jHUCMjIe30Se82kYh4="
	</script>
	<script src="/public/js/utils.js?v=202001082219"></script>
	
	
		<script src="/public/js/contest.js?v=202001082219"></script>
		<link href="/public/css/contest.css?v=202001082219" rel="stylesheet" />
		<script>
			var contestScreenName = "dp";
			var remainingText = "Remaining Time";
			var countDownText = "Contest begins in";
			var startTime = moment("2019-01-06T20:00:00+09:00");
			var endTime = moment("2019-01-07T01:00:00+09:00");
		</script>
		<style></style>
	
	
		<script type="text/x-mathjax-config">MathJax.Hub.Config({messageStyle:"none",tex2jax:{skipTags:["script","noscript","style","textarea","code"],inlineMath:[['\\(','\\)']]},delayStartupUntil:"onload"});</script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
		<script>$(function(){$('var').each(function(){$(this).html('\\('+$(this).html()+'\\)');});});</script>
	
	
	
	
		<script src="//cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
	
	
	
	
	
	
	
	
	
	
	<script src="/public/js/base.js?v=202001082219"></script>
	<script src="/public/js/ga.js?v=202001082219"></script>
</head>

<body>

<div id="main-div" >


	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/home"></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav">
				
					<li><a class="contest-title" href="/contests/dp">Educational DP Contest</a></li>
				
				</ul>
				<ul class="nav navbar-nav navbar-right">
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
							<img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/contests/dp/tasks_print?lang=ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語</a></li>
							<li><a href="/contests/dp/tasks_print?lang=en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English</a></li>
						</ul>
					</li>
					
					
						<li><a href="/register?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Fdp%2Ftasks_print">Sign Up</a></li>
						<li><a href="/login?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Fdp%2Ftasks_print">Sign In</a></li>
					
				</ul>
			</div>
		</div>
	</nav>

	<form method="POST" name="form_logout" action="/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Fdp%2Ftasks_print">
		<input type="hidden" name="csrf_token" value="gIStXCUVNaXNFe0BRIdLuLl88jHUCMjIe30Se82kYh4=" />
	</form>
	<div id="main-container" class="container"
		 	style="">
		

<script>var PRINT = true;</script>
<style>
	@media print {
		#main-container { padding: 0;}
	}
	pre {
		white-space: pre-wrap;
	}
	.next-page {
		margin-top: 50px;
		page-break-after: always;
	}
	div.part { page-break-inside: avoid;}
</style>
<div class="row">
	
		
		<div class="col-sm-12">
			<span class="h2">A - Frog 1</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 個の足場があります。
足場には <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、足場 <var>i</var> の高さは <var>h_i</var> です。</p>
<p>最初、足場 <var>1</var> にカエルがいます。
カエルは次の行動を何回か繰り返し、足場 <var>N</var> まで辿り着こうとしています。</p>
<ul>
<li>足場 <var>i</var> にいるとき、足場 <var>i + 1</var> または <var>i + 2</var> へジャンプする。 このとき、ジャンプ先の足場を <var>j</var> とすると、コスト <var>|h_i - h_j|</var> を支払う。</li>
</ul>
<p>カエルが足場 <var>N</var> に辿り着くまでに支払うコストの総和の最小値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>2 \leq N \leq 10^5</var></li>
<li><var>1 \leq h_i \leq 10^4</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>h_1</var> <var>h_2</var> <var>\ldots</var> <var>h_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>カエルが支払うコストの総和の最小値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>4
10 30 40 20
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>30
</pre>

<p>足場 <var>1</var> → <var>2</var> → <var>4</var> と移動すると、コストの総和は <var>|10 - 30| + |30 - 20| = 30</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>2
10 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>0
</pre>

<p>足場 <var>1</var> → <var>2</var> と移動すると、コストの総和は <var>|10 - 10| = 0</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>6
30 10 60 10 60 50
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>40
</pre>

<p>足場 <var>1</var> → <var>3</var> → <var>5</var> → <var>6</var> と移動すると、コストの総和は <var>|30 - 60| + |60 - 60| + |60 - 50| = 40</var> となります。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> stones, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N</var>), the height of Stone <var>i</var> is <var>h_i</var>.</p>
<p>There is a frog who is initially on Stone <var>1</var>.
He will repeat the following action some number of times to reach Stone <var>N</var>:</p>
<ul>
<li>If the frog is currently on Stone <var>i</var>, jump to Stone <var>i + 1</var> or Stone <var>i + 2</var>. Here, a cost of <var>|h_i - h_j|</var> is incurred, where <var>j</var> is the stone to land on.</li>
</ul>
<p>Find the minimum possible total cost incurred before the frog reaches Stone <var>N</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>2 \leq N \leq 10^5</var></li>
<li><var>1 \leq h_i \leq 10^4</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>h_1</var> <var>h_2</var> <var>\ldots</var> <var>h_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the minimum possible total cost incurred.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4
10 30 40 20
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>30
</pre>

<p>If we follow the path <var>1</var> → <var>2</var> → <var>4</var>, the total cost incurred would be <var>|10 - 30| + |30 - 20| = 30</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>2
10 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
</pre>

<p>If we follow the path <var>1</var> → <var>2</var>, the total cost incurred would be <var>|10 - 10| = 0</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>6
30 10 60 10 60 50
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>40
</pre>

<p>If we follow the path <var>1</var> → <var>3</var> → <var>5</var> → <var>6</var>, the total cost incurred would be <var>|30 - 60| + |60 - 60| + |60 - 50| = 40</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">B - Frog 2</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 個の足場があります。
足場には <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、足場 <var>i</var> の高さは <var>h_i</var> です。</p>
<p>最初、足場 <var>1</var> にカエルがいます。
カエルは次の行動を何回か繰り返し、足場 <var>N</var> まで辿り着こうとしています。</p>
<ul>
<li>足場 <var>i</var> にいるとき、足場 <var>i + 1, i + 2, \ldots, i + K</var> のどれかへジャンプする。 このとき、ジャンプ先の足場を <var>j</var> とすると、コスト <var>|h_i - h_j|</var> を支払う。</li>
</ul>
<p>カエルが足場 <var>N</var> に辿り着くまでに支払うコストの総和の最小値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>2 \leq N \leq 10^5</var></li>
<li><var>1 \leq K \leq 100</var></li>
<li><var>1 \leq h_i \leq 10^4</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>K</var>
<var>h_1</var> <var>h_2</var> <var>\ldots</var> <var>h_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>カエルが支払うコストの総和の最小値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>5 3
10 30 40 50 20
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>30
</pre>

<p>足場 <var>1</var> → <var>2</var> → <var>5</var> と移動すると、コストの総和は <var>|10 - 30| + |30 - 20| = 30</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>3 1
10 20 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>20
</pre>

<p>足場 <var>1</var> → <var>2</var> → <var>3</var> と移動すると、コストの総和は <var>|10 - 20| + |20 - 10| = 20</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>2 100
10 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>0
</pre>

<p>足場 <var>1</var> → <var>2</var> と移動すると、コストの総和は <var>|10 - 10| = 0</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>10 4
40 10 20 70 80 10 20 70 80 60
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>40
</pre>

<p>足場 <var>1</var> → <var>4</var> → <var>8</var> → <var>10</var> と移動すると、コストの総和は <var>|40 - 70| + |70 - 70| + |70 - 60| = 40</var> となります。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> stones, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N</var>), the height of Stone <var>i</var> is <var>h_i</var>.</p>
<p>There is a frog who is initially on Stone <var>1</var>.
He will repeat the following action some number of times to reach Stone <var>N</var>:</p>
<ul>
<li>If the frog is currently on Stone <var>i</var>, jump to one of the following: Stone <var>i + 1, i + 2, \ldots, i + K</var>. Here, a cost of <var>|h_i - h_j|</var> is incurred, where <var>j</var> is the stone to land on.</li>
</ul>
<p>Find the minimum possible total cost incurred before the frog reaches Stone <var>N</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>2 \leq N \leq 10^5</var></li>
<li><var>1 \leq K \leq 100</var></li>
<li><var>1 \leq h_i \leq 10^4</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>K</var>
<var>h_1</var> <var>h_2</var> <var>\ldots</var> <var>h_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the minimum possible total cost incurred.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>5 3
10 30 40 50 20
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>30
</pre>

<p>If we follow the path <var>1</var> → <var>2</var> → <var>5</var>, the total cost incurred would be <var>|10 - 30| + |30 - 20| = 30</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3 1
10 20 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>20
</pre>

<p>If we follow the path <var>1</var> → <var>2</var> → <var>3</var>, the total cost incurred would be <var>|10 - 20| + |20 - 10| = 20</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>2 100
10 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0
</pre>

<p>If we follow the path <var>1</var> → <var>2</var>, the total cost incurred would be <var>|10 - 10| = 0</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>10 4
40 10 20 70 80 10 20 70 80 60
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>40
</pre>

<p>If we follow the path <var>1</var> → <var>4</var> → <var>8</var> → <var>10</var>, the total cost incurred would be <var>|40 - 70| + |70 - 70| + |70 - 60| = 40</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">C - Vacation</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>明日から太郎君の夏休みが始まります。
太郎君は夏休みの計画を立てることにしました。</p>
<p>夏休みは <var>N</var> 日からなります。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、<var>i</var> 日目には太郎君は次の活動のうちひとつを選んで行います。</p>
<ul>
<li>A: 海で泳ぐ。 幸福度 <var>a_i</var> を得る。</li>
<li>B: 山で虫取りをする。 幸福度 <var>b_i</var> を得る。</li>
<li>C: 家で宿題をする。 幸福度 <var>c_i</var> を得る。</li>
</ul>
<p>太郎君は飽き性なので、<var>2</var> 日以上連続で同じ活動を行うことはできません。</p>
<p>太郎君が得る幸福度の総和の最大値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 10^5</var></li>
<li><var>1 \leq a_i, b_i, c_i \leq 10^4</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>a_1</var> <var>b_1</var> <var>c_1</var>
<var>a_2</var> <var>b_2</var> <var>c_2</var>
<var>:</var>
<var>a_N</var> <var>b_N</var> <var>c_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>太郎君が得る幸福度の総和の最大値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3
10 40 70
20 50 80
30 60 90
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>210
</pre>

<p>C, B, C の順に活動を行うと、幸福度の総和は <var>70 + 50 + 90 = 210</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>1
100 10 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>100
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>7
6 7 8
8 8 3
2 5 2
7 8 6
4 6 8
2 3 4
7 5 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>46
</pre>

<p>C, A, B, A, C, B, A の順に活動を行えばよいです。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Taro's summer vacation starts tomorrow, and he has decided to make plans for it now.</p>
<p>The vacation consists of <var>N</var> days.
For each <var>i</var> (<var>1 \leq i \leq N</var>), Taro will choose one of the following activities and do it on the <var>i</var>-th day:</p>
<ul>
<li>A: Swim in the sea. Gain <var>a_i</var> points of happiness.</li>
<li>B: Catch bugs in the mountains. Gain <var>b_i</var> points of happiness.</li>
<li>C: Do homework at home. Gain <var>c_i</var> points of happiness.</li>
</ul>
<p>As Taro gets bored easily, he cannot do the same activities for two or more consecutive days.</p>
<p>Find the maximum possible total points of happiness that Taro gains.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 10^5</var></li>
<li><var>1 \leq a_i, b_i, c_i \leq 10^4</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>a_1</var> <var>b_1</var> <var>c_1</var>
<var>a_2</var> <var>b_2</var> <var>c_2</var>
<var>:</var>
<var>a_N</var> <var>b_N</var> <var>c_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the maximum possible total points of happiness that Taro gains.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
10 40 70
20 50 80
30 60 90
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>210
</pre>

<p>If Taro does activities in the order C, B, C, he will gain <var>70 + 50 + 90 = 210</var> points of happiness.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>1
100 10 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>100
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>7
6 7 8
8 8 3
2 5 2
7 8 6
4 6 8
2 3 4
7 5 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>46
</pre>

<p>Taro should do activities in the order C, A, B, A, C, B, A.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">D - Knapsack 1</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 個の品物があります。
品物には <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、品物 <var>i</var> の重さは <var>w_i</var> で、価値は <var>v_i</var> です。</p>
<p>太郎君は、<var>N</var> 個の品物のうちいくつかを選び、ナップサックに入れて持ち帰ることにしました。
ナップサックの容量は <var>W</var> であり、持ち帰る品物の重さの総和は <var>W</var> 以下でなければなりません。</p>
<p>太郎君が持ち帰る品物の価値の総和の最大値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 100</var></li>
<li><var>1 \leq W \leq 10^5</var></li>
<li><var>1 \leq w_i \leq W</var></li>
<li><var>1 \leq v_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>W</var>
<var>w_1</var> <var>v_1</var>
<var>w_2</var> <var>v_2</var>
<var>:</var>
<var>w_N</var> <var>v_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>太郎君が持ち帰る品物の価値の総和の最大値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3 8
3 30
4 50
5 60
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>90
</pre>

<p>品物 <var>1, 3</var> を選べばよいです。
すると、重さの総和は <var>3 + 5 = 8</var> となり、価値の総和は <var>30 + 60 = 90</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>5 5
1 1000000000
1 1000000000
1 1000000000
1 1000000000
1 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>5000000000
</pre>

<p>答えは 32-bit 整数型に収まらない場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>6 15
6 5
5 6
6 4
6 6
3 5
7 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>17
</pre>

<p>品物 <var>2, 4, 5</var> を選べばよいです。
すると、重さの総和は <var>5 + 6 + 3 = 14</var> となり、価値の総和は <var>6 + 6 + 5 = 17</var> となります。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> items, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N</var>), Item <var>i</var> has a weight of <var>w_i</var> and a value of <var>v_i</var>.</p>
<p>Taro has decided to choose some of the <var>N</var> items and carry them home in a knapsack.
The capacity of the knapsack is <var>W</var>, which means that the sum of the weights of items taken must be at most <var>W</var>.</p>
<p>Find the maximum possible sum of the values of items that Taro takes home.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 100</var></li>
<li><var>1 \leq W \leq 10^5</var></li>
<li><var>1 \leq w_i \leq W</var></li>
<li><var>1 \leq v_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>W</var>
<var>w_1</var> <var>v_1</var>
<var>w_2</var> <var>v_2</var>
<var>:</var>
<var>w_N</var> <var>v_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the maximum possible sum of the values of items that Taro takes home.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 8
3 30
4 50
5 60
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>90
</pre>

<p>Items <var>1</var> and <var>3</var> should be taken.
Then, the sum of the weights is <var>3 + 5 = 8</var>, and the sum of the values is <var>30 + 60 = 90</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5 5
1 1000000000
1 1000000000
1 1000000000
1 1000000000
1 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>5000000000
</pre>

<p>The answer may not fit into a 32-bit integer type.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>6 15
6 5
5 6
6 4
6 6
3 5
7 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>17
</pre>

<p>Items <var>2, 4</var> and <var>5</var> should be taken.
Then, the sum of the weights is <var>5 + 6 + 3 = 14</var>, and the sum of the values is <var>6 + 6 + 5 = 17</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">E - Knapsack 2</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 個の品物があります。
品物には <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、品物 <var>i</var> の重さは <var>w_i</var> で、価値は <var>v_i</var> です。</p>
<p>太郎君は、<var>N</var> 個の品物のうちいくつかを選び、ナップサックに入れて持ち帰ることにしました。
ナップサックの容量は <var>W</var> であり、持ち帰る品物の重さの総和は <var>W</var> 以下でなければなりません。</p>
<p>太郎君が持ち帰る品物の価値の総和の最大値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 100</var></li>
<li><var>1 \leq W \leq 10^9</var></li>
<li><var>1 \leq w_i \leq W</var></li>
<li><var>1 \leq v_i \leq 10^3</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>W</var>
<var>w_1</var> <var>v_1</var>
<var>w_2</var> <var>v_2</var>
<var>:</var>
<var>w_N</var> <var>v_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>太郎君が持ち帰る品物の価値の総和の最大値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3 8
3 30
4 50
5 60
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>90
</pre>

<p>品物 <var>1, 3</var> を選べばよいです。
すると、重さの総和は <var>3 + 5 = 8</var> となり、価値の総和は <var>30 + 60 = 90</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>1 1000000000
1000000000 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>10
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>6 15
6 5
5 6
6 4
6 6
3 5
7 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>17
</pre>

<p>品物 <var>2, 4, 5</var> を選べばよいです。
すると、重さの総和は <var>5 + 6 + 3 = 14</var> となり、価値の総和は <var>6 + 6 + 5 = 17</var> となります。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> items, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N</var>), Item <var>i</var> has a weight of <var>w_i</var> and a value of <var>v_i</var>.</p>
<p>Taro has decided to choose some of the <var>N</var> items and carry them home in a knapsack.
The capacity of the knapsack is <var>W</var>, which means that the sum of the weights of items taken must be at most <var>W</var>.</p>
<p>Find the maximum possible sum of the values of items that Taro takes home.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 100</var></li>
<li><var>1 \leq W \leq 10^9</var></li>
<li><var>1 \leq w_i \leq W</var></li>
<li><var>1 \leq v_i \leq 10^3</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>W</var>
<var>w_1</var> <var>v_1</var>
<var>w_2</var> <var>v_2</var>
<var>:</var>
<var>w_N</var> <var>v_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the maximum possible sum of the values of items that Taro takes home.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 8
3 30
4 50
5 60
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>90
</pre>

<p>Items <var>1</var> and <var>3</var> should be taken.
Then, the sum of the weights is <var>3 + 5 = 8</var>, and the sum of the values is <var>30 + 60 = 90</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>1 1000000000
1000000000 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>10
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>6 15
6 5
5 6
6 4
6 6
3 5
7 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>17
</pre>

<p>Items <var>2, 4</var> and <var>5</var> should be taken.
Then, the sum of the weights is <var>5 + 6 + 3 = 14</var>, and the sum of the values is <var>6 + 6 + 5 = 17</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">F - LCS</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>文字列 <var>s</var> および <var>t</var> が与えられます。
<var>s</var> の部分列かつ <var>t</var> の部分列であるような文字列のうち、最長のものをひとつ求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>注釈</h3><p>文字列 <var>x</var> の<em>部分列</em>とは、<var>x</var> から <var>0</var> 個以上の文字を取り除いた後、残りの文字を元の順序で連結して得られる文字列のことです。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>s</var> および <var>t</var> は英小文字からなる文字列である。</li>
<li><var>1 \leq |s|, |t| \leq 3000</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>s</var>
<var>t</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p><var>s</var> の部分列かつ <var>t</var> の部分列であるような文字列のうち、最長のものをひとつ出力せよ。
答えが複数ある場合、どれを出力してもよい。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>axyb
abyxb
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>axb
</pre>

<p>答えは <code>axb</code> または <code>ayb</code> です。
どちらを出力しても正解となります。 </p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>aa
xayaz
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>aa
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>a
z
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>
</pre>

<p>答えは <code></code> (空文字列) です。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>abracadabra
avadakedavra
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>aaadara
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>You are given strings <var>s</var> and <var>t</var>.
Find one longest string that is a subsequence of both <var>s</var> and <var>t</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Notes</h3><p>A <em>subsequence</em> of a string <var>x</var> is the string obtained by removing zero or more characters from <var>x</var> and concatenating the remaining characters without changing the order.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>s</var> and <var>t</var> are strings consisting of lowercase English letters.</li>
<li><var>1 \leq |s|, |t| \leq 3000</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>s</var>
<var>t</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print one longest string that is a subsequence of both <var>s</var> and <var>t</var>.
If there are multiple such strings, any of them will be accepted.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>axyb
abyxb
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>axb
</pre>

<p>The answer is <code>axb</code> or <code>ayb</code>; either will be accepted.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>aa
xayaz
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>aa
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>a
z
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>
</pre>

<p>The answer is <code></code> (an empty string).</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>abracadabra
avadakedavra
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>aaadara
</pre></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">G - Longest Path</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 頂点 <var>M</var> 辺の有向グラフ <var>G</var> があります。
頂点には <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq M</var>) について、<var>i</var> 番目の有向辺は頂点 <var>x_i</var> から <var>y_i</var> へ張られています。
<var>G</var> は<strong>有向閉路を含みません</strong>。</p>
<p><var>G</var> の有向パスのうち、最長のものの長さを求めてください。
ただし、有向パスの長さとは、有向パスに含まれる辺の本数のことです。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>2 \leq N \leq 10^5</var></li>
<li><var>1 \leq M \leq 10^5</var></li>
<li><var>1 \leq x_i, y_i \leq N</var></li>
<li>ペア <var>(x_i, y_i)</var> はすべて相異なる。</li>
<li><var>G</var> は<strong>有向閉路を含まない</strong>。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>M</var>
<var>x_1</var> <var>y_1</var>
<var>x_2</var> <var>y_2</var>
<var>:</var>
<var>x_M</var> <var>y_M</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p><var>G</var> の有向パスのうち、最長のものの長さを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>4 5
1 2
1 3
3 2
2 4
3 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>3
</pre>

<p>次図の赤い有向パスが最長です。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/longest_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>6 3
2 3
4 5
5 6
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>2
</pre>

<p>次図の赤い有向パスが最長です。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/longest_1_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>5 8
5 3
2 3
2 4
5 2
5 1
1 4
4 3
1 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>3
</pre>

<p>例えば、次図の赤い有向パスが最長です。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/longest_2_muffet.png" /></p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a directed graph <var>G</var> with <var>N</var> vertices and <var>M</var> edges.
The vertices are numbered <var>1, 2, \ldots, N</var>, and for each <var>i</var> (<var>1 \leq i \leq M</var>), the <var>i</var>-th directed edge goes from Vertex <var>x_i</var> to <var>y_i</var>.
<var>G</var> <strong>does not contain directed cycles</strong>.</p>
<p>Find the length of the longest directed path in <var>G</var>.
Here, the length of a directed path is the number of edges in it.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>2 \leq N \leq 10^5</var></li>
<li><var>1 \leq M \leq 10^5</var></li>
<li><var>1 \leq x_i, y_i \leq N</var></li>
<li>All pairs <var>(x_i, y_i)</var> are distinct.</li>
<li><var>G</var> <strong>does not contain directed cycles</strong>.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>M</var>
<var>x_1</var> <var>y_1</var>
<var>x_2</var> <var>y_2</var>
<var>:</var>
<var>x_M</var> <var>y_M</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the length of the longest directed path in <var>G</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4 5
1 2
1 3
3 2
2 4
3 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>3
</pre>

<p>The red directed path in the following figure is the longest:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/longest_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>6 3
2 3
4 5
5 6
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>2
</pre>

<p>The red directed path in the following figure is the longest:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/longest_1_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5 8
5 3
2 3
2 4
5 2
5 1
1 4
4 3
1 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>3
</pre>

<p>The red directed path in the following figure is one of the longest:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/longest_2_muffet.png" /></p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">H - Grid 1</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>縦 <var>H</var> 行、横 <var>W</var> 列のグリッドがあります。
上から <var>i</var> 行目、左から <var>j</var> 列目のマスを <var>(i, j)</var> で表します。</p>
<p>各 <var>i, j</var> (<var>1 \leq i \leq H</var>, <var>1 \leq j \leq W</var>) について、マス <var>(i, j)</var> の情報が文字 <var>a_{i, j}</var> によって与えられます。
<var>a_{i, j}</var> が <code>.</code> ならばマス <var>(i, j)</var> は空マスであり、<var>a_{i, j}</var> が <code>#</code> ならばマス <var>(i, j)</var> は壁のマスです。
マス <var>(1, 1)</var> および <var>(H, W)</var> は空マスであることが保証されています。</p>
<p>太郎君は、マス <var>(1, 1)</var> から出発し、右または下に隣り合う空マスへの移動を繰り返すことで、マス <var>(H, W)</var> まで辿り着こうとしています。</p>
<p>マス <var>(1, 1)</var> から <var>(H, W)</var> までの太郎君の経路は何通りでしょうか？
答えは非常に大きくなりうるので、<var>10^9 + 7</var> で割った余りを求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>H</var> および <var>W</var> は整数である。</li>
<li><var>2 \leq H, W \leq 1000</var></li>
<li><var>a_{i, j}</var> は <code>.</code> または <code>#</code> である。</li>
<li>マス <var>(1, 1)</var> および <var>(H, W)</var> は空マスである。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>H</var> <var>W</var>
<var>a_{1, 1}</var><var>\ldots</var><var>a_{1, W}</var>
<var>:</var>
<var>a_{H, 1}</var><var>\ldots</var><var>a_{H, W}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>マス <var>(1, 1)</var> から <var>(H, W)</var> までの太郎君の経路は何通りか？
<var>10^9 + 7</var> で割った余りを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3 4
...#
.#..
....
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>3
</pre>

<p>経路は次図の <var>3</var> 通りです。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/grid_0_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>5 2
..
#.
..
.#
..
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>0
</pre>

<p>経路が存在しない場合もあります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>5 5
..#..
.....
#...#
.....
..#..
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>24
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>20 20
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>345263555
</pre>

<p>答えを <var>10^9 + 7</var> で割った余りを出力することを忘れずに。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a grid with <var>H</var> horizontal rows and <var>W</var> vertical columns.
Let <var>(i, j)</var> denote the square at the <var>i</var>-th row from the top and the <var>j</var>-th column from the left.</p>
<p>For each <var>i</var> and <var>j</var> (<var>1 \leq i \leq H</var>, <var>1 \leq j \leq W</var>), Square <var>(i, j)</var> is described by a character <var>a_{i, j}</var>.
If <var>a_{i, j}</var> is <code>.</code>, Square <var>(i, j)</var> is an empty square; if <var>a_{i, j}</var> is <code>#</code>, Square <var>(i, j)</var> is a wall square.
It is guaranteed that Squares <var>(1, 1)</var> and <var>(H, W)</var> are empty squares.</p>
<p>Taro will start from Square <var>(1, 1)</var> and reach <var>(H, W)</var> by repeatedly moving right or down to an adjacent empty square.</p>
<p>Find the number of Taro's paths from Square <var>(1, 1)</var> to <var>(H, W)</var>.
As the answer can be extremely large, find the count modulo <var>10^9 + 7</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>H</var> and <var>W</var> are integers.</li>
<li><var>2 \leq H, W \leq 1000</var></li>
<li><var>a_{i, j}</var> is <code>.</code> or <code>#</code>.</li>
<li>Squares <var>(1, 1)</var> and <var>(H, W)</var> are empty squares.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>H</var> <var>W</var>
<var>a_{1, 1}</var><var>\ldots</var><var>a_{1, W}</var>
<var>:</var>
<var>a_{H, 1}</var><var>\ldots</var><var>a_{H, W}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the number of Taro's paths from Square <var>(1, 1)</var> to <var>(H, W)</var>, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 4
...#
.#..
....
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>3
</pre>

<p>There are three paths as follows:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/grid_0_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5 2
..
#.
..
.#
..
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
</pre>

<p>There may be no paths.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5 5
..#..
.....
#...#
.....
..#..
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>24
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>20 20
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>345263555
</pre>

<p>Be sure to print the count modulo <var>10^9 + 7</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">I - Coins</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> を正の奇数とします。</p>
<p><var>N</var> 枚のコインがあります。
コインには <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、コイン <var>i</var> を投げると、確率 <var>p_i</var> で表が出て、確率 <var>1 - p_i</var> で裏が出ます。</p>
<p>太郎君は <var>N</var> 枚のコインをすべて投げました。
このとき、表の個数が裏の個数を上回る確率を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>N</var> は奇数である。</li>
<li><var>1 \leq N \leq 2999</var></li>
<li><var>p_i</var> は実数であり、小数第 <var>2</var> 位まで与えられる。</li>
<li><var>0 &lt; p_i &lt; 1</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>p_1</var> <var>p_2</var> <var>\ldots</var> <var>p_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>表の個数が裏の個数を上回る確率を出力せよ。
絶対誤差が <var>10^{-9}</var> 以下ならば正解となる。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3
0.30 0.60 0.80
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>0.612
</pre>

<p>表の個数が裏の個数を上回るような各ケースの確率を計算すると、次のようになります。</p>
<ul>
<li><var>(コイン 1, コイン 2, コイン 3) = (表, 表, 表)</var> となる確率は、<var>0.3 × 0.6 × 0.8 = 0.144</var> である。</li>
<li><var>(コイン 1, コイン 2, コイン 3) = (裏, 表, 表)</var> となる確率は、<var>0.7 × 0.6 × 0.8 = 0.336</var> である。</li>
<li><var>(コイン 1, コイン 2, コイン 3) = (表, 裏, 表)</var> となる確率は、<var>0.3 × 0.4 × 0.8 = 0.096</var> である。</li>
<li><var>(コイン 1, コイン 2, コイン 3) = (表, 表, 裏)</var> となる確率は、<var>0.3 × 0.6 × 0.2 = 0.036</var> である。</li>
</ul>
<p>よって、表の個数が裏の個数を上回る確率は、<var>0.144 + 0.336 + 0.096 + 0.036 = 0.612</var> です。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>1
0.50
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>0.5
</pre>

<p>例えば、<code>0.500</code>, <code>0.500000001</code>, <code>0.499999999</code> などを出力しても正解となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>5
0.42 0.01 0.42 0.99 0.42
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>0.3821815872
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Let <var>N</var> be a positive odd number.</p>
<p>There are <var>N</var> coins, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N</var>), when Coin <var>i</var> is tossed, it comes up heads with probability <var>p_i</var> and tails with probability <var>1 - p_i</var>.</p>
<p>Taro has tossed all the <var>N</var> coins.
Find the probability of having more heads than tails.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>N</var> is an odd number.</li>
<li><var>1 \leq N \leq 2999</var></li>
<li><var>p_i</var> is a real number and has two decimal places.</li>
<li><var>0 &lt; p_i &lt; 1</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>p_1</var> <var>p_2</var> <var>\ldots</var> <var>p_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the probability of having more heads than tails.
The output is considered correct when the absolute error is not greater than <var>10^{-9}</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
0.30 0.60 0.80
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>0.612
</pre>

<p>The probability of each case where we have more heads than tails is as follows:</p>
<ul>
<li>The probability of having <var>(Coin 1, Coin 2, Coin 3) = (Head, Head, Head)</var> is <var>0.3 × 0.6 × 0.8 = 0.144</var>;</li>
<li>The probability of having <var>(Coin 1, Coin 2, Coin 3) = (Tail, Head, Head)</var> is <var>0.7 × 0.6 × 0.8 = 0.336</var>;</li>
<li>The probability of having <var>(Coin 1, Coin 2, Coin 3) = (Head, Tail, Head)</var> is <var>0.3 × 0.4 × 0.8 = 0.096</var>;</li>
<li>The probability of having <var>(Coin 1, Coin 2, Coin 3) = (Head, Head, Tail)</var> is <var>0.3 × 0.6 × 0.2 = 0.036</var>.</li>
</ul>
<p>Thus, the probability of having more heads than tails is <var>0.144 + 0.336 + 0.096 + 0.036 = 0.612</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>1
0.50
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0.5
</pre>

<p>Outputs such as <code>0.500</code>, <code>0.500000001</code> and <code>0.499999999</code> are also considered correct.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5
0.42 0.01 0.42 0.99 0.42
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0.3821815872
</pre></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">J - Sushi</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 枚の皿があります。
皿には <var>1, 2, \ldots, N</var> と番号が振られています。
最初、各 <var>i</var> (<var>1 \leq i \leq N</var>) について、皿 <var>i</var> には <var>a_i</var> (<var>1 \leq a_i \leq 3)</var> 個の寿司が置かれています。</p>
<p>すべての寿司が無くなるまで、太郎君は次の操作を繰り返し行います。</p>
<ul>
<li><var>1, 2, \ldots, N</var> の目が等確率で出るサイコロを振り、出目を <var>i</var> とする。 皿 <var>i</var> に寿司がある場合、皿 <var>i</var> の寿司を <var>1</var> 個食べる。 皿 <var>i</var> に寿司が無い場合、何も行わない。</li>
</ul>
<p>すべての寿司が無くなるまでの操作回数の期待値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 300</var></li>
<li><var>1 \leq a_i \leq 3</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>すべての寿司が無くなるまでの操作回数の期待値を出力せよ。
相対誤差が <var>10^{-9}</var> 以下ならば正解となる。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3
1 1 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>5.5
</pre>

<p><var>1</var> 個目の寿司を食べるまでの操作回数の期待値は <var>1</var> です。
その後、<var>2</var> 個目の寿司を食べるまでの操作回数の期待値は <var>1.5</var> です。
その後、<var>3</var> 個目の寿司を食べるまでの操作回数の期待値は <var>3</var> です。
よって、全体の操作回数の期待値は <var>1 + 1.5 + 3 = 5.5</var> です。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>1
3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>3
</pre>

<p>例えば、<code>3.00</code>, <code>3.000000003</code>, <code>2.999999997</code> などを出力しても正解となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>2
1 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>4.5
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>10
1 3 2 3 3 2 3 2 1 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>54.48064457488221
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> dishes, numbered <var>1, 2, \ldots, N</var>.
Initially, for each <var>i</var> (<var>1 \leq i \leq N</var>), Dish <var>i</var> has <var>a_i</var> (<var>1 \leq a_i \leq 3</var>) pieces of sushi on it.</p>
<p>Taro will perform the following operation repeatedly until all the pieces of sushi are eaten:</p>
<ul>
<li>Roll a die that shows the numbers <var>1, 2, \ldots, N</var> with equal probabilities, and let <var>i</var> be the outcome. If there are some pieces of sushi on Dish <var>i</var>, eat one of them; if there is none, do nothing.</li>
</ul>
<p>Find the expected number of times the operation is performed before all the pieces of sushi are eaten.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 300</var></li>
<li><var>1 \leq a_i \leq 3</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the expected number of times the operation is performed before all the pieces of sushi are eaten.
The output is considered correct when the relative difference is not greater than <var>10^{-9}</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
1 1 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>5.5
</pre>

<p>The expected number of operations before the first piece of sushi is eaten, is <var>1</var>.
After that, the expected number of operations before the second sushi is eaten, is <var>1.5</var>.
After that, the expected number of operations before the third sushi is eaten, is <var>3</var>.
Thus, the expected total number of operations is <var>1 + 1.5 + 3 = 5.5</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>1
3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>3
</pre>

<p>Outputs such as <code>3.00</code>, <code>3.000000003</code> and <code>2.999999997</code> will also be accepted.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>2
1 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>4.5
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>10
1 3 2 3 3 2 3 2 1 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>54.48064457488221
</pre></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">K - Stones</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 個の正整数からなる集合 <var>A = \{ a_1, a_2, \ldots, a_N \}</var> があります。
太郎君と次郎君が次のゲームで勝負します。</p>
<p>最初に、<var>K</var> 個の石からなる山を用意します。
二人は次の操作を交互に行います。
先手は太郎君です。</p>
<ul>
<li><var>A</var> の元 <var>x</var> をひとつ選び、山からちょうど <var>x</var> 個の石を取り去る。</li>
</ul>
<p>先に操作を行えなくなった人が負けです。
二人が最適に行動すると仮定したとき、どちらが勝つかを判定してください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 100</var></li>
<li><var>1 \leq K \leq 10^5</var></li>
<li><var>1 \leq a_1 &lt; a_2 &lt; \cdots &lt; a_N \leq K</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>K</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>先手の太郎君が勝つならば <code>First</code> を、後手の次郎君が勝つならば <code>Second</code> を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>2 4
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>First
</pre>

<p>先手が <var>3</var> 個の石を取り去ると、後手は操作を行なえません。
よって、先手が勝ちます。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>2 5
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>Second
</pre>

<p>次のように、先手がどのように操作を行っても後手が勝ちます。</p>
<ul>
<li>先手が <var>2</var> 個の石を取り去った場合、後手が <var>3</var> 個の石を取り去ると、先手は操作を行えない。</li>
<li>先手が <var>3</var> 個の石を取り去った場合、後手が <var>2</var> 個の石を取り去ると、先手は操作を行えない。</li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>2 7
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>First
</pre>

<p>先手は <var>2</var> 個の石を取り去ればよいです。
すると、次のように、後手がどのように操作を行っても先手が勝ちます。</p>
<ul>
<li>後手が <var>2</var> 個の石を取り去った場合、先手が <var>3</var> 個の石を取り去ると、後手は操作を行えない。</li>
<li>後手が <var>3</var> 個の石を取り去った場合、先手が <var>2</var> 個の石を取り去ると、後手は操作を行えない。</li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>3 20
1 2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>Second
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 5</h3><pre>3 21
1 2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 5</h3><pre>First
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 6</h3><pre>1 100000
1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 6</h3><pre>Second
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a set <var>A = \{ a_1, a_2, \ldots, a_N \}</var> consisting of <var>N</var> positive integers.
Taro and Jiro will play the following game against each other.</p>
<p>Initially, we have a pile consisting of <var>K</var> stones.
The two players perform the following operation alternately, starting from Taro:</p>
<ul>
<li>Choose an element <var>x</var> in <var>A</var>, and remove exactly <var>x</var> stones from the pile.</li>
</ul>
<p>A player loses when he becomes unable to play.
Assuming that both players play optimally, determine the winner.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 100</var></li>
<li><var>1 \leq K \leq 10^5</var></li>
<li><var>1 \leq a_1 &lt; a_2 &lt; \cdots &lt; a_N \leq K</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>K</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>If Taro will win, print <code>First</code>; if Jiro will win, print <code>Second</code>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>2 4
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>First
</pre>

<p>If Taro removes three stones, Jiro cannot make a move.
Thus, Taro wins.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>2 5
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>Second
</pre>

<p>Whatever Taro does in his operation, Jiro wins, as follows:</p>
<ul>
<li>If Taro removes two stones, Jiro can remove three stones to make Taro unable to make a move.</li>
<li>If Taro removes three stones, Jiro can remove two stones to make Taro unable to make a move.</li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>2 7
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>First
</pre>

<p>Taro should remove two stones. Then, whatever Jiro does in his operation, Taro wins, as follows:</p>
<ul>
<li>If Jiro removes two stones, Taro can remove three stones to make Jiro unable to make a move.</li>
<li>If Jiro removes three stones, Taro can remove two stones to make Jiro unable to make a move.</li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>3 20
1 2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>Second
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 5</h3><pre>3 21
1 2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 5</h3><pre>First
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 6</h3><pre>1 100000
1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 6</h3><pre>Second
</pre></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">L - Deque</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>太郎君と次郎君が次のゲームで勝負します。</p>
<p>最初に、数列 <var>a = (a_1, a_2, \ldots, a_N)</var> が与えられます。
<var>a</var> が空になるまで、二人は次の操作を交互に行います。
先手は太郎君です。</p>
<ul>
<li><var>a</var> の先頭要素または末尾要素を取り除く。 取り除いた要素を <var>x</var> とすると、操作を行った人は <var>x</var> 点を得る。</li>
</ul>
<p>ゲーム終了時の太郎君の総得点を <var>X</var>、次郎君の総得点を <var>Y</var> とします。
太郎君は <var>X - Y</var> を最大化しようとし、次郎君は <var>X - Y</var> を最小化しようとします。</p>
<p>二人が最適に行動すると仮定したとき、<var>X - Y</var> を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 3000</var></li>
<li><var>1 \leq a_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>二人が最適に行動すると仮定したとき、<var>X - Y</var> を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>4
10 80 90 30
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>10
</pre>

<p>二人が最適に行動すると、次のように操作が行われます。
操作対象の要素を太字で表しています。</p>
<ul>
<li>先手: (10, 80, 90, <strong>30</strong>) → (10, 80, 90)</li>
<li>後手: (10, 80, <strong>90</strong>) → (10, 80)</li>
<li>先手: (10, <strong>80</strong>) → (10)</li>
<li>後手: (<strong>10</strong>) → ()</li>
</ul>
<p>このとき、<var>X = 30 + 80 = 110</var>, <var>Y = 90 + 10 = 100</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>3
10 100 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>-80
</pre>

<p>二人が最適に行動すると、例えば次のように操作が行われます。</p>
<ul>
<li>先手: (<strong>10</strong>, 100, 10) → (100, 10)</li>
<li>後手: (<strong>100</strong>, 10) → (10)</li>
<li>先手: (<strong>10</strong>) → ()</li>
</ul>
<p>このとき、<var>X = 10 + 10 = 20</var>, <var>Y = 100</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>1
10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>10
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>10
1000000000 1 1000000000 1 1000000000 1 1000000000 1 1000000000 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>4999999995
</pre>

<p>答えは 32-bit 整数型に収まらない場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 5</h3><pre>6
4 2 9 7 1 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 5</h3><pre>2
</pre>

<p>二人が最適に行動すると、例えば次のように操作が行われます。</p>
<ul>
<li>先手: (4, 2, 9, 7, 1, <strong>5</strong>) → (4, 2, 9, 7, 1)</li>
<li>後手: (<strong>4</strong>, 2, 9, 7, 1) → (2, 9, 7, 1)</li>
<li>先手: (2, 9, 7, <strong>1</strong>) → (2, 9, 7)</li>
<li>後手: (2, 9, <strong>7</strong>) → (2, 9)</li>
<li>先手: (2, <strong>9</strong>) → (2)</li>
<li>後手: (<strong>2</strong>) → ()</li>
</ul>
<p>このとき、<var>X = 5 + 1 + 9 = 15</var>, <var>Y = 4 + 7 + 2 = 13</var> となります。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Taro and Jiro will play the following game against each other.</p>
<p>Initially, they are given a sequence <var>a = (a_1, a_2, \ldots, a_N)</var>.
Until <var>a</var> becomes empty, the two players perform the following operation alternately, starting from Taro:</p>
<ul>
<li>Remove the element at the beginning or the end of <var>a</var>. The player earns <var>x</var> points, where <var>x</var> is the removed element.</li>
</ul>
<p>Let <var>X</var> and <var>Y</var> be Taro's and Jiro's total score at the end of the game, respectively.
Taro tries to maximize <var>X - Y</var>, while Jiro tries to minimize <var>X - Y</var>.</p>
<p>Assuming that the two players play optimally, find the resulting value of <var>X - Y</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 3000</var></li>
<li><var>1 \leq a_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the resulting value of <var>X - Y</var>, assuming that the two players play optimally.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4
10 80 90 30
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>10
</pre>

<p>The game proceeds as follows when the two players play optimally (the element being removed is written bold):</p>
<ul>
<li>Taro: (10, 80, 90, <strong>30</strong>) → (10, 80, 90)</li>
<li>Jiro: (10, 80, <strong>90</strong>) → (10, 80)</li>
<li>Taro: (10, <strong>80</strong>) → (10)</li>
<li>Jiro: (<strong>10</strong>) → ()</li>
</ul>
<p>Here, <var>X = 30 + 80 = 110</var> and <var>Y = 90 + 10 = 100</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3
10 100 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>-80
</pre>

<p>The game proceeds, for example, as follows when the two players play optimally:</p>
<ul>
<li>Taro: (<strong>10</strong>, 100, 10) → (100, 10)</li>
<li>Jiro: (<strong>100</strong>, 10) → (10)</li>
<li>Taro: (<strong>10</strong>) → ()</li>
</ul>
<p>Here, <var>X = 10 + 10 = 20</var> and <var>Y = 100</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>1
10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>10
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>10
1000000000 1 1000000000 1 1000000000 1 1000000000 1 1000000000 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>4999999995
</pre>

<p>The answer may not fit into a 32-bit integer type.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 5</h3><pre>6
4 2 9 7 1 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 5</h3><pre>2
</pre>

<p>The game proceeds, for example, as follows when the two players play optimally:</p>
<ul>
<li>Taro: (4, 2, 9, 7, 1, <strong>5</strong>) → (4, 2, 9, 7, 1)</li>
<li>Jiro: (<strong>4</strong>, 2, 9, 7, 1) → (2, 9, 7, 1)</li>
<li>Taro: (2, 9, 7, <strong>1</strong>) → (2, 9, 7)</li>
<li>Jiro: (2, 9, <strong>7</strong>) → (2, 9)</li>
<li>Taro: (2, <strong>9</strong>) → (2)</li>
<li>Jiro: (<strong>2</strong>) → ()</li>
</ul>
<p>Here, <var>X = 5 + 1 + 9 = 15</var> and <var>Y = 4 + 7 + 2 = 13</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">M - Candies</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 人の子供たちがいます。
子供たちには <var>1, 2, \ldots, N</var> と番号が振られています。</p>
<p>子供たちは <var>K</var> 個の飴を分け合うことにしました。
このとき、各 <var>i</var> (<var>1 \leq i \leq N</var>) について、子供 <var>i</var> が受け取る飴の個数は <var>0</var> 以上 <var>a_i</var> 以下でなければなりません。
また、飴が余ってはいけません。</p>
<p>子供たちが飴を分け合う方法は何通りでしょうか？
<var>10^9 + 7</var> で割った余りを求めてください。
ただし、<var>2</var> 通りの方法が異なるとは、ある子供が存在し、その子供が受け取る飴の個数が異なることを言います。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 100</var></li>
<li><var>0 \leq K \leq 10^5</var></li>
<li><var>0 \leq a_i \leq K</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>K</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>子供たちが飴を分け合う方法は何通りか？
<var>10^9 + 7</var> で割った余りを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3 4
1 2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>5
</pre>

<p>子供たちが飴を分け合う方法は、次の <var>5</var> 通りです。
各数列において、<var>i</var> 番目の要素は子供 <var>i</var> が受け取る飴の個数を表します。</p>
<ul>
<li><var>(0, 1, 3)</var></li>
<li><var>(0, 2, 2)</var></li>
<li><var>(1, 0, 3)</var></li>
<li><var>(1, 1, 2)</var></li>
<li><var>(1, 2, 1)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>1 10
9
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>0
</pre>

<p>子供たちが飴を分け合う方法が存在しない場合もあります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>2 0
0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>1
</pre>

<p>子供たちが飴を分け合う方法は、次の <var>1</var> 通りです。</p>
<ul>
<li><var>(0, 0)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>4 100000
100000 100000 100000 100000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>665683269
</pre>

<p>答えを <var>10^9 + 7</var> で割った余りを出力することを忘れずに。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> children, numbered <var>1, 2, \ldots, N</var>.</p>
<p>They have decided to share <var>K</var> candies among themselves.
Here, for each <var>i</var> (<var>1 \leq i \leq N</var>), Child <var>i</var> must receive between <var>0</var> and <var>a_i</var> candies (inclusive).
Also, no candies should be left over.</p>
<p>Find the number of ways for them to share candies, modulo <var>10^9 + 7</var>.
Here, two ways are said to be different when there exists a child who receives a different number of candies.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 100</var></li>
<li><var>0 \leq K \leq 10^5</var></li>
<li><var>0 \leq a_i \leq K</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>K</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the number of ways for the children to share candies, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 4
1 2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>5
</pre>

<p>There are five ways for the children to share candies, as follows:</p>
<ul>
<li><var>(0, 1, 3)</var></li>
<li><var>(0, 2, 2)</var></li>
<li><var>(1, 0, 3)</var></li>
<li><var>(1, 1, 2)</var></li>
<li><var>(1, 2, 1)</var></li>
</ul>
<p>Here, in each sequence, the <var>i</var>-th element represents the number of candies that Child <var>i</var> receives.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>1 10
9
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
</pre>

<p>There may be no ways for the children to share candies.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>2 0
0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>1
</pre>

<p>There is one way for the children to share candies, as follows:</p>
<ul>
<li><var>(0, 0)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>4 100000
100000 100000 100000 100000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>665683269
</pre>

<p>Be sure to print the answer modulo <var>10^9 + 7</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">N - Slimes</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 匹のスライムが横一列に並んでいます。
最初、左から <var>i</var> 番目のスライムの大きさは <var>a_i</var> です。</p>
<p>太郎君は、すべてのスライムを合体させて <var>1</var> 匹のスライムにしようとしています。
スライムが <var>1</var> 匹になるまで、太郎君は次の操作を繰り返し行います。</p>
<ul>
<li>左右に隣り合う <var>2</var> 匹のスライムを選び、それらを合体させて新しい <var>1</var> 匹のスライムにする。 合体前の <var>2</var> 匹のスライムの大きさを <var>x</var> および <var>y</var> とすると、合体後のスライムの大きさは <var>x + y</var> となる。 このとき、太郎君は <var>x + y</var> のコストを支払う。 なお、合体の前後でスライムたちの位置関係は変わらない。</li>
</ul>
<p>太郎君が支払うコストの総和の最小値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>2 \leq N \leq 400</var></li>
<li><var>1 \leq a_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>太郎君が支払うコストの総和の最小値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>4
10 20 30 40
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>190
</pre>

<p>次のように操作を行えばよいです。
操作対象のスライムを太字で表しています。</p>
<ul>
<li>(<strong>10</strong>, <strong>20</strong>, 30, 40) → (<strong>30</strong>, 30, 40)</li>
<li>(<strong>30</strong>, <strong>30</strong>, 40) → (<strong>60</strong>, 40)</li>
<li>(<strong>60</strong>, <strong>40</strong>) → (<strong>100</strong>)</li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>5
10 10 10 10 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>120
</pre>

<p>例えば、次のように操作を行えばよいです。</p>
<ul>
<li>(<strong>10</strong>, <strong>10</strong>, 10, 10, 10) → (<strong>20</strong>, 10, 10, 10)</li>
<li>(20, <strong>10</strong>, <strong>10</strong>, 10) → (20, <strong>20</strong>, 10)</li>
<li>(20, <strong>20</strong>, <strong>10</strong>) → (20, <strong>30</strong>)</li>
<li>(<strong>20</strong>, <strong>30</strong>) → (<strong>50</strong>)</li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>3
1000000000 1000000000 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>5000000000
</pre>

<p>答えは 32-bit 整数型に収まらない場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>6
7 6 8 6 1 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>68
</pre>

<p>例えば、次のように操作を行えばよいです。</p>
<ul>
<li>(7, 6, 8, 6, <strong>1</strong>, <strong>1</strong>) → (7, 6, 8, 6, <strong>2</strong>)</li>
<li>(7, 6, 8, <strong>6</strong>, <strong>2</strong>) → (7, 6, 8, <strong>8</strong>)</li>
<li>(<strong>7</strong>, <strong>6</strong>, 8, 8) → (<strong>13</strong>, 8, 8)</li>
<li>(13, <strong>8</strong>, <strong>8</strong>) → (13, <strong>16</strong>)</li>
<li>(<strong>13</strong>, <strong>16</strong>) → (<strong>29</strong>)</li>
</ul></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> slimes lining up in a row.
Initially, the <var>i</var>-th slime from the left has a size of <var>a_i</var>.</p>
<p>Taro is trying to combine all the slimes into a larger slime.
He will perform the following operation repeatedly until there is only one slime:</p>
<ul>
<li>Choose two adjacent slimes, and combine them into a new slime. The new slime has a size of <var>x + y</var>, where <var>x</var> and <var>y</var> are the sizes of the slimes before combining them. Here, a cost of <var>x + y</var> is incurred. The positional relationship of the slimes does not change while combining slimes.</li>
</ul>
<p>Find the minimum possible total cost incurred.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>2 \leq N \leq 400</var></li>
<li><var>1 \leq a_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the minimum possible total cost incurred.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4
10 20 30 40
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>190
</pre>

<p>Taro should do as follows (slimes being combined are shown in bold):</p>
<ul>
<li>(<strong>10</strong>, <strong>20</strong>, 30, 40) → (<strong>30</strong>, 30, 40)</li>
<li>(<strong>30</strong>, <strong>30</strong>, 40) → (<strong>60</strong>, 40)</li>
<li>(<strong>60</strong>, <strong>40</strong>) → (<strong>100</strong>)</li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5
10 10 10 10 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>120
</pre>

<p>Taro should do, for example, as follows:</p>
<ul>
<li>(<strong>10</strong>, <strong>10</strong>, 10, 10, 10) → (<strong>20</strong>, 10, 10, 10)</li>
<li>(20, <strong>10</strong>, <strong>10</strong>, 10) → (20, <strong>20</strong>, 10)</li>
<li>(20, <strong>20</strong>, <strong>10</strong>) → (20, <strong>30</strong>)</li>
<li>(<strong>20</strong>, <strong>30</strong>) → (<strong>50</strong>)</li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>3
1000000000 1000000000 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>5000000000
</pre>

<p>The answer may not fit into a 32-bit integer type.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>6
7 6 8 6 1 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>68
</pre>

<p>Taro should do, for example, as follows:</p>
<ul>
<li>(7, 6, 8, 6, <strong>1</strong>, <strong>1</strong>) → (7, 6, 8, 6, <strong>2</strong>)</li>
<li>(7, 6, 8, <strong>6</strong>, <strong>2</strong>) → (7, 6, 8, <strong>8</strong>)</li>
<li>(<strong>7</strong>, <strong>6</strong>, 8, 8) → (<strong>13</strong>, 8, 8)</li>
<li>(13, <strong>8</strong>, <strong>8</strong>) → (13, <strong>16</strong>)</li>
<li>(<strong>13</strong>, <strong>16</strong>) → (<strong>29</strong>)</li>
</ul></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">O - Matching</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 人の男性たちと <var>N</var> 人の女性たちがいます。
男性たちには <var>1, 2, \ldots, N</var> と番号が振られています。
同様に、女性たちには <var>1, 2, \ldots, N</var> と番号が振られています。</p>
<p>各 <var>i, j</var> (<var>1 \leq i, j \leq N</var>) について、男性 <var>i</var> と女性 <var>j</var> の相性の良し悪しが整数 <var>a_{i, j}</var> によって与えられます。
<var>a_{i, j} = 1</var> ならば男性 <var>i</var> と女性 <var>j</var> は相性が良く、<var>a_{i, j} = 0</var> ならば相性が悪いです。</p>
<p>太郎君は、相性が良い男女どうしのペアを <var>N</var> 組作ろうとしています。
このとき、各男性および各女性はちょうど <var>1</var> つのペアに属さなければなりません。</p>
<p><var>N</var> 組のペアを作る方法は何通りでしょうか？
<var>10^9 + 7</var> で割った余りを求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 21</var></li>
<li><var>a_{i, j}</var> は <var>0</var> または <var>1</var> である。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>a_{1, 1}</var> <var>\ldots</var> <var>a_{1, N}</var>
<var>:</var>
<var>a_{N, 1}</var> <var>\ldots</var> <var>a_{N, N}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p><var>N</var> 組のペアを作る方法は何通りか？
<var>10^9 + 7</var> で割った余りを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3
0 1 1
1 0 1
1 1 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>3
</pre>

<p>ペアを作る方法は次の <var>3</var> 通りです。
男性 <var>i</var> と女性 <var>j</var> のペアを <var>(i, j)</var> で表します。</p>
<ul>
<li><var>(1, 2), (2, 1), (3, 3)</var></li>
<li><var>(1, 2), (2, 3), (3, 1)</var></li>
<li><var>(1, 3), (2, 1), (3, 2)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>4
0 1 0 0
0 0 0 1
1 0 0 0
0 0 1 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>1
</pre>

<p>ペアを作る方法は次の <var>1</var> 通りです。</p>
<ul>
<li><var>(1, 2), (2, 4), (3, 1), (4, 3)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>1
0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>0
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>21
0 0 0 0 0 0 0 1 1 0 1 1 1 1 0 0 0 1 0 0 1
1 1 1 0 0 1 0 0 0 1 0 0 0 0 1 1 1 0 1 1 0
0 0 1 1 1 1 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1
0 1 1 0 1 1 0 1 0 1 0 0 1 0 0 0 0 0 1 1 0
1 1 0 0 1 0 1 0 0 1 1 1 1 0 0 0 0 0 0 0 0
0 1 1 0 1 1 1 0 1 1 1 0 0 0 1 1 1 1 0 0 1
0 1 0 0 0 1 0 1 0 0 0 1 1 1 0 0 1 1 0 1 0
0 0 0 0 1 1 0 0 1 1 0 0 0 0 0 1 1 1 1 1 1
0 0 1 0 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 1
0 0 0 0 1 1 0 0 1 1 1 0 0 0 0 1 1 0 0 0 1
0 1 1 0 1 1 0 0 1 1 0 0 0 1 1 1 1 0 1 1 0
0 0 1 0 0 1 1 1 1 0 1 1 0 1 1 1 0 0 0 0 1
0 1 1 0 0 1 1 1 1 0 0 0 1 0 1 1 0 1 0 1 1
1 1 1 1 1 0 0 0 0 1 0 0 1 1 0 1 1 1 0 0 1
0 0 0 1 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1
1 0 1 1 0 1 0 1 0 0 1 0 0 1 1 0 1 0 1 1 0
0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 1 1 0 0 1
0 0 0 1 0 0 1 1 0 1 0 1 0 1 1 0 0 1 1 0 1
0 0 0 0 1 1 1 0 1 0 1 1 1 0 1 1 0 0 1 1 0
1 1 0 1 1 0 0 1 1 0 1 1 0 1 1 1 1 1 0 1 0
1 0 0 1 1 0 1 1 1 1 1 0 1 0 1 1 0 0 0 0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>102515160
</pre>

<p>答えを <var>10^9 + 7</var> で割った余りを出力することを忘れずに。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> men and <var>N</var> women, both numbered <var>1, 2, \ldots, N</var>.</p>
<p>For each <var>i, j</var> (<var>1 \leq i, j \leq N</var>), the compatibility of Man <var>i</var> and Woman <var>j</var> is given as an integer <var>a_{i, j}</var>.
If <var>a_{i, j} = 1</var>, Man <var>i</var> and Woman <var>j</var> are compatible; if <var>a_{i, j} = 0</var>, they are not.</p>
<p>Taro is trying to make <var>N</var> pairs, each consisting of a man and a woman who are compatible.
Here, each man and each woman must belong to exactly one pair.</p>
<p>Find the number of ways in which Taro can make <var>N</var> pairs, modulo <var>10^9 + 7</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 21</var></li>
<li><var>a_{i, j}</var> is <var>0</var> or <var>1</var>.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>a_{1, 1}</var> <var>\ldots</var> <var>a_{1, N}</var>
<var>:</var>
<var>a_{N, 1}</var> <var>\ldots</var> <var>a_{N, N}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the number of ways in which Taro can make <var>N</var> pairs, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
0 1 1
1 0 1
1 1 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>3
</pre>

<p>There are three ways to make pairs, as follows (<var>(i, j)</var> denotes a pair of Man <var>i</var> and Woman <var>j</var>):</p>
<ul>
<li><var>(1, 2), (2, 1), (3, 3)</var></li>
<li><var>(1, 2), (2, 3), (3, 1)</var></li>
<li><var>(1, 3), (2, 1), (3, 2)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>4
0 1 0 0
0 0 0 1
1 0 0 0
0 0 1 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>1
</pre>

<p>There is one way to make pairs, as follows:</p>
<ul>
<li><var>(1, 2), (2, 4), (3, 1), (4, 3)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>1
0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>21
0 0 0 0 0 0 0 1 1 0 1 1 1 1 0 0 0 1 0 0 1
1 1 1 0 0 1 0 0 0 1 0 0 0 0 1 1 1 0 1 1 0
0 0 1 1 1 1 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1
0 1 1 0 1 1 0 1 0 1 0 0 1 0 0 0 0 0 1 1 0
1 1 0 0 1 0 1 0 0 1 1 1 1 0 0 0 0 0 0 0 0
0 1 1 0 1 1 1 0 1 1 1 0 0 0 1 1 1 1 0 0 1
0 1 0 0 0 1 0 1 0 0 0 1 1 1 0 0 1 1 0 1 0
0 0 0 0 1 1 0 0 1 1 0 0 0 0 0 1 1 1 1 1 1
0 0 1 0 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 1
0 0 0 0 1 1 0 0 1 1 1 0 0 0 0 1 1 0 0 0 1
0 1 1 0 1 1 0 0 1 1 0 0 0 1 1 1 1 0 1 1 0
0 0 1 0 0 1 1 1 1 0 1 1 0 1 1 1 0 0 0 0 1
0 1 1 0 0 1 1 1 1 0 0 0 1 0 1 1 0 1 0 1 1
1 1 1 1 1 0 0 0 0 1 0 0 1 1 0 1 1 1 0 0 1
0 0 0 1 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1
1 0 1 1 0 1 0 1 0 0 1 0 0 1 1 0 1 0 1 1 0
0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 1 1 0 0 1
0 0 0 1 0 0 1 1 0 1 0 1 0 1 1 0 0 1 1 0 1
0 0 0 0 1 1 1 0 1 0 1 1 1 0 1 1 0 0 1 1 0
1 1 0 1 1 0 0 1 1 0 1 1 0 1 1 1 1 1 0 1 0
1 0 0 1 1 0 1 1 1 1 1 0 1 0 1 1 0 0 0 0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>102515160
</pre>

<p>Be sure to print the number modulo <var>10^9 + 7</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">P - Independent Set</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 頂点の木があります。
頂点には <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N - 1</var>) について、<var>i</var> 番目の辺は頂点 <var>x_i</var> と <var>y_i</var> を結んでいます。</p>
<p>太郎君は、各頂点を白または黒で塗ることにしました。
ただし、隣り合う頂点どうしをともに黒で塗ってはいけません。</p>
<p>頂点の色の組合せは何通りでしょうか？
<var>10^9 + 7</var> で割った余りを求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 10^5</var></li>
<li><var>1 \leq x_i, y_i \leq N</var></li>
<li>与えられるグラフは木である。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>x_1</var> <var>y_1</var>
<var>x_2</var> <var>y_2</var>
<var>:</var>
<var>x_{N - 1}</var> <var>y_{N - 1}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>頂点の色の組合せは何通りか？
<var>10^9 + 7</var> で割った余りを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3
1 2
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>5
</pre>

<p>頂点の色の組合せは次図の <var>5</var> 通りです。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/indep_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>4
1 2
1 3
1 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>9
</pre>

<p>頂点の色の組合せは次図の <var>9</var> 通りです。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/indep_1_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>2
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>10
8 5
10 8
6 5
1 5
4 8
2 10
3 6
9 2
1 7
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>157
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a tree with <var>N</var> vertices, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N - 1</var>), the <var>i</var>-th edge connects Vertex <var>x_i</var> and <var>y_i</var>.</p>
<p>Taro has decided to paint each vertex in white or black.
Here, it is not allowed to paint two adjacent vertices both in black.</p>
<p>Find the number of ways in which the vertices can be painted, modulo <var>10^9 + 7</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 10^5</var></li>
<li><var>1 \leq x_i, y_i \leq N</var></li>
<li>The given graph is a tree.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>x_1</var> <var>y_1</var>
<var>x_2</var> <var>y_2</var>
<var>:</var>
<var>x_{N - 1}</var> <var>y_{N - 1}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the number of ways in which the vertices can be painted, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
1 2
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>5
</pre>

<p>There are five ways to paint the vertices, as follows:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/indep_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>4
1 2
1 3
1 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>9
</pre>

<p>There are nine ways to paint the vertices, as follows:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/indep_1_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>2
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>10
8 5
10 8
6 5
1 5
4 8
2 10
3 6
9 2
1 7
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>157
</pre></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">Q - Flowers</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 本の花が横一列に並んでいます。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、左から <var>i</var> 番目の花の高さは <var>h_i</var> で、美しさは <var>a_i</var> です。
ただし、<var>h_1, h_2, \ldots, h_N</var> はすべて相異なります。</p>
<p>太郎君は何本かの花を抜き去ることで、次の条件が成り立つようにしようとしています。</p>
<ul>
<li>残りの花を左から順に見ると、高さが単調増加になっている。</li>
</ul>
<p>残りの花の美しさの総和の最大値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 2 × 10^5</var></li>
<li><var>1 \leq h_i \leq N</var></li>
<li><var>h_1, h_2, \ldots, h_N</var> はすべて相異なる。</li>
<li><var>1 \leq a_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>h_1</var> <var>h_2</var> <var>\ldots</var> <var>h_N</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>残りの花の美しさの総和の最大値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>4
3 1 4 2
10 20 30 40
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>60
</pre>

<p>左から <var>2, 4</var> 番目の花を残せばよいです。
すると、高さは左から順に <var>1, 2</var> となり、単調増加になっています。
また、美しさの総和は <var>20 + 40 = 60</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>1
1
10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>10
</pre>

<p>最初から条件が成り立っています。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>5
1 2 3 4 5
1000000000 1000000000 1000000000 1000000000 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>5000000000
</pre>

<p>答えは 32-bit 整数型に収まらない場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>9
4 2 5 8 3 6 1 7 9
6 8 8 4 6 3 5 7 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>31
</pre>

<p>左から <var>2, 3, 6, 8, 9</var> 番目の花を残せばよいです。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> flowers arranged in a row.
For each <var>i</var> (<var>1 \leq i \leq N</var>), the height and the beauty of the <var>i</var>-th flower from the left is <var>h_i</var> and <var>a_i</var>, respectively.
Here, <var>h_1, h_2, \ldots, h_N</var> are all distinct.</p>
<p>Taro is pulling out some flowers so that the following condition is met:</p>
<ul>
<li>The heights of the remaining flowers are monotonically increasing from left to right.</li>
</ul>
<p>Find the maximum possible sum of the beauties of the remaining flowers.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 2 × 10^5</var></li>
<li><var>1 \leq h_i \leq N</var></li>
<li><var>h_1, h_2, \ldots, h_N</var> are all distinct.</li>
<li><var>1 \leq a_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>h_1</var> <var>h_2</var> <var>\ldots</var> <var>h_N</var>
<var>a_1</var> <var>a_2</var> <var>\ldots</var> <var>a_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the maximum possible sum of the beauties of the remaining flowers.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4
3 1 4 2
10 20 30 40
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>60
</pre>

<p>We should keep the second and fourth flowers from the left.
Then, the heights would be <var>1, 2</var> from left to right, which is monotonically increasing, and the sum of the beauties would be <var>20 + 40 = 60</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>1
1
10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>10
</pre>

<p>The condition is met already at the beginning.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5
1 2 3 4 5
1000000000 1000000000 1000000000 1000000000 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>5000000000
</pre>

<p>The answer may not fit into a 32-bit integer type.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>9
4 2 5 8 3 6 1 7 9
6 8 8 4 6 3 5 7 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>31
</pre>

<p>We should keep the second, third, sixth, eighth and ninth flowers from the left.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">R - Walk</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 頂点の単純有向グラフ <var>G</var> があります。
頂点には <var>1, 2, \ldots, N</var> と番号が振られています。</p>
<p>各 <var>i, j</var> (<var>1 \leq i, j \leq N</var>) について、頂点 <var>i</var> から <var>j</var> への有向辺の有無が整数 <var>a_{i, j}</var> によって与えられます。
<var>a_{i, j} = 1</var> ならば頂点 <var>i</var> から <var>j</var> への有向辺が存在し、<var>a_{i, j} = 0</var> ならば存在しません。</p>
<p><var>G</var> の長さ <var>K</var> の有向パスは何通りでしょうか？
<var>10^9 + 7</var> で割った余りを求めてください。
ただし、同じ辺を複数回通るような有向パスも数えるものとします。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 50</var></li>
<li><var>1 \leq K \leq 10^{18}</var></li>
<li><var>a_{i, j}</var> は <var>0</var> または <var>1</var> である。</li>
<li><var>a_{i, i} = 0</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>K</var>
<var>a_{1, 1}</var> <var>\ldots</var> <var>a_{1, N}</var>
<var>:</var>
<var>a_{N, 1}</var> <var>\ldots</var> <var>a_{N, N}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p><var>G</var> の長さ <var>K</var> の有向パスは何通りか？
<var>10^9 + 7</var> で割った余りを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>4 2
0 1 0 0
0 0 1 1
0 0 0 1
1 0 0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>6
</pre>

<p><var>G</var> は次図です。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/paths_0_muffet.png" /></p>
<p>長さ <var>2</var> の有向パスは、次の <var>6</var> 通りです。</p>
<ul>
<li><var>1</var> → <var>2</var> → <var>3</var></li>
<li><var>1</var> → <var>2</var> → <var>4</var></li>
<li><var>2</var> → <var>3</var> → <var>4</var></li>
<li><var>2</var> → <var>4</var> → <var>1</var></li>
<li><var>3</var> → <var>4</var> → <var>1</var></li>
<li><var>4</var> → <var>1</var> → <var>2</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>3 3
0 1 0
1 0 1
0 0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>3
</pre>

<p><var>G</var> は次図です。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/paths_1_muffet.png" /></p>
<p>長さ <var>3</var> の有向パスは、次の <var>3</var> 通りです。</p>
<ul>
<li><var>1</var> → <var>2</var> → <var>1</var> → <var>2</var></li>
<li><var>2</var> → <var>1</var> → <var>2</var> → <var>1</var></li>
<li><var>2</var> → <var>1</var> → <var>2</var> → <var>3</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>6 2
0 0 0 0 0 0
0 0 1 0 0 0
0 0 0 0 0 0
0 0 0 0 1 0
0 0 0 0 0 1
0 0 0 0 0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>1
</pre>

<p><var>G</var> は次図です。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/paths_2_muffet.png" /></p>
<p>長さ <var>2</var> の有向パスは、次の <var>1</var> 通りです。</p>
<ul>
<li><var>4</var> → <var>5</var> → <var>6</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>1 1
0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>0
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 5</h3><pre>10 1000000000000000000
0 0 1 1 0 0 0 1 1 0
0 0 0 0 0 1 1 1 0 0
0 1 0 0 0 1 0 1 0 1
1 1 1 0 1 1 0 1 1 0
0 1 1 1 0 1 0 1 1 1
0 0 0 1 0 0 1 0 1 0
0 0 0 1 1 0 0 1 0 1
1 0 0 0 1 0 1 0 0 0
0 0 0 0 0 1 0 0 0 0
1 0 1 1 1 0 1 1 1 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 5</h3><pre>957538352
</pre>

<p>答えを <var>10^9 + 7</var> で割った余りを出力することを忘れずに。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a simple directed graph <var>G</var> with <var>N</var> vertices, numbered <var>1, 2, \ldots, N</var>.</p>
<p>For each <var>i</var> and <var>j</var> (<var>1 \leq i, j \leq N</var>), you are given an integer <var>a_{i, j}</var> that represents whether there is a directed edge from Vertex <var>i</var> to <var>j</var>.
If <var>a_{i, j} = 1</var>, there is a directed edge from Vertex <var>i</var> to <var>j</var>; if <var>a_{i, j} = 0</var>, there is not.</p>
<p>Find the number of different directed paths of length <var>K</var> in <var>G</var>, modulo <var>10^9 + 7</var>.
We will also count a path that traverses the same edge multiple times.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 50</var></li>
<li><var>1 \leq K \leq 10^{18}</var></li>
<li><var>a_{i, j}</var> is <var>0</var> or <var>1</var>.</li>
<li><var>a_{i, i} = 0</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>K</var>
<var>a_{1, 1}</var> <var>\ldots</var> <var>a_{1, N}</var>
<var>:</var>
<var>a_{N, 1}</var> <var>\ldots</var> <var>a_{N, N}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the number of different directed paths of length <var>K</var> in <var>G</var>, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4 2
0 1 0 0
0 0 1 1
0 0 0 1
1 0 0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>6
</pre>

<p><var>G</var> is drawn in the figure below:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/paths_0_muffet.png" /></p>
<p>There are six directed paths of length <var>2</var>:</p>
<ul>
<li><var>1</var> → <var>2</var> → <var>3</var></li>
<li><var>1</var> → <var>2</var> → <var>4</var></li>
<li><var>2</var> → <var>3</var> → <var>4</var></li>
<li><var>2</var> → <var>4</var> → <var>1</var></li>
<li><var>3</var> → <var>4</var> → <var>1</var></li>
<li><var>4</var> → <var>1</var> → <var>2</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3 3
0 1 0
1 0 1
0 0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>3
</pre>

<p><var>G</var> is drawn in the figure below:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/paths_1_muffet.png" /></p>
<p>There are three directed paths of length <var>3</var>:</p>
<ul>
<li><var>1</var> → <var>2</var> → <var>1</var> → <var>2</var></li>
<li><var>2</var> → <var>1</var> → <var>2</var> → <var>1</var></li>
<li><var>2</var> → <var>1</var> → <var>2</var> → <var>3</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>6 2
0 0 0 0 0 0
0 0 1 0 0 0
0 0 0 0 0 0
0 0 0 0 1 0
0 0 0 0 0 1
0 0 0 0 0 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>1
</pre>

<p><var>G</var> is drawn in the figure below:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/paths_2_muffet.png" /></p>
<p>There is one directed path of length <var>2</var>:</p>
<ul>
<li><var>4</var> → <var>5</var> → <var>6</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>1 1
0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>0
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 5</h3><pre>10 1000000000000000000
0 0 1 1 0 0 0 1 1 0
0 0 0 0 0 1 1 1 0 0
0 1 0 0 0 1 0 1 0 1
1 1 1 0 1 1 0 1 1 0
0 1 1 1 0 1 0 1 1 1
0 0 0 1 0 0 1 0 1 0
0 0 0 1 1 0 0 1 0 1
1 0 0 0 1 0 1 0 0 0
0 0 0 0 0 1 0 0 0 0
1 0 1 1 1 0 1 1 1 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 5</h3><pre>957538352
</pre>

<p>Be sure to print the count modulo <var>10^9 + 7</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">S - Digit Sum</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>1</var> 以上 <var>K</var> 以下の整数のうち、十進表記における各桁の数字の総和が <var>D</var> の倍数であるようなものは何個でしょうか？
<var>10^9 + 7</var> で割った余りを求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq K &lt; 10^{10000}</var></li>
<li><var>1 \leq D \leq 100</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>K</var>
<var>D</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>条件を満たす整数は何個か？
<var>10^9 + 7</var> で割った余りを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>30
4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>6
</pre>

<p><var>4, 8, 13, 17, 22, 26</var> の <var>6</var> 個です。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>1000000009
1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>2
</pre>

<p>答えを <var>10^9 + 7</var> で割った余りを出力することを忘れずに。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>98765432109876543210
58
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>635270834
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Find the number of integers between <var>1</var> and <var>K</var> (inclusive) satisfying the following condition, modulo <var>10^9 + 7</var>:</p>
<ul>
<li>The sum of the digits in base ten is a multiple of <var>D</var>.</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq K &lt; 10^{10000}</var></li>
<li><var>1 \leq D \leq 100</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>K</var>
<var>D</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the number of integers satisfying the condition, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>30
4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>6
</pre>

<p>Those six integers are: <var>4, 8, 13, 17, 22</var> and <var>26</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>1000000009
1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>2
</pre>

<p>Be sure to print the number modulo <var>10^9 + 7</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>98765432109876543210
58
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>635270834
</pre></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">T - Permutation</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> を正整数とします。
長さ <var>N - 1</var> の文字列 <var>s</var> が与えられます。
<var>s</var> は <code>&lt;</code> と <code>&gt;</code> からなります。</p>
<p><var>(1, 2, \ldots, N)</var> を並べ替えた順列 <var>(p_1, p_2, \ldots, p_N)</var> であって、次の条件を満たすものは何通りでしょうか？
<var>10^9 + 7</var> で割った余りを求めてください。</p>
<ul>
<li>各 <var>i</var> (<var>1 \leq i \leq N - 1</var>) について、<var>s</var> の <var>i</var> 文字目が <code>&lt;</code> の場合は <var>p_i &lt; p_{i + 1}</var> であり、<var>s</var> の <var>i</var> 文字目が <code>&gt;</code> の場合は <var>p_i &gt; p_{i + 1}</var> である。</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>N</var> は整数である。</li>
<li><var>2 \leq N \leq 3000</var></li>
<li><var>s</var> は長さ <var>N - 1</var> の文字列である。</li>
<li><var>s</var> は <code>&lt;</code> と <code>&gt;</code> からなる。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>s</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>条件を満たす順列は何通りか？
<var>10^9 + 7</var> で割った余りを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>4
&lt;&gt;&lt;
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>5
</pre>

<p>条件を満たす順列は次の <var>5</var> 通りです。</p>
<ul>
<li><var>(1, 3, 2, 4)</var></li>
<li><var>(1, 4, 2, 3)</var></li>
<li><var>(2, 3, 1, 4)</var></li>
<li><var>(2, 4, 1, 3)</var></li>
<li><var>(3, 4, 1, 2)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>5
&lt;&lt;&lt;&lt;
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>1
</pre>

<p>条件を満たす順列は次の <var>1</var> 通りです。</p>
<ul>
<li><var>(1, 2, 3, 4, 5)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>20
&gt;&gt;&gt;&gt;&lt;&gt;&gt;&gt;&lt;&gt;&gt;&lt;&gt;&gt;&gt;&lt;&lt;&gt;&gt;
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>217136290
</pre>

<p>答えを <var>10^9 + 7</var> で割った余りを出力することを忘れずに。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Let <var>N</var> be a positive integer.
You are given a string <var>s</var> of length <var>N - 1</var>, consisting of <code>&lt;</code> and <code>&gt;</code>.</p>
<p>Find the number of permutations <var>(p_1, p_2, \ldots, p_N)</var> of <var>(1, 2, \ldots, N)</var> that satisfy the following condition, modulo <var>10^9 + 7</var>:</p>
<ul>
<li>For each <var>i</var> (<var>1 \leq i \leq N - 1</var>), <var>p_i &lt; p_{i + 1}</var> if the <var>i</var>-th character in <var>s</var> is <code>&lt;</code>, and <var>p_i &gt; p_{i + 1}</var> if the <var>i</var>-th character in <var>s</var> is <code>&gt;</code>.</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>N</var> is an integer.</li>
<li><var>2 \leq N \leq 3000</var></li>
<li><var>s</var> is a string of length <var>N - 1</var>.</li>
<li><var>s</var> consists of <code>&lt;</code> and <code>&gt;</code>.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>s</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the number of permutations that satisfy the condition, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4
&lt;&gt;&lt;
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>5
</pre>

<p>There are five permutations that satisfy the condition, as follows:</p>
<ul>
<li><var>(1, 3, 2, 4)</var></li>
<li><var>(1, 4, 2, 3)</var></li>
<li><var>(2, 3, 1, 4)</var></li>
<li><var>(2, 4, 1, 3)</var></li>
<li><var>(3, 4, 1, 2)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5
&lt;&lt;&lt;&lt;
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>1
</pre>

<p>There is one permutation that satisfies the condition, as follows:</p>
<ul>
<li><var>(1, 2, 3, 4, 5)</var></li>
</ul>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>20
&gt;&gt;&gt;&gt;&lt;&gt;&gt;&gt;&lt;&gt;&gt;&lt;&gt;&gt;&gt;&lt;&lt;&gt;&gt;
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>217136290
</pre>

<p>Be sure to print the number modulo <var>10^9 + 7</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">U - Grouping</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 羽のうさぎたちがいます。
うさぎたちには <var>1, 2, \ldots, N</var> と番号が振られています。</p>
<p>各 <var>i, j</var> (<var>1 \leq i, j \leq N</var>) について、うさぎ <var>i</var> と <var>j</var> の相性が整数 <var>a_{i, j}</var> によって与えられます。
ただし、各 <var>i</var> (<var>1 \leq i \leq N</var>) について <var>a_{i, i} = 0</var> であり、各 <var>i, j</var> (<var>1 \leq i, j \leq N</var>) について <var>a_{i, j} = a_{j, i}</var> です。</p>
<p>太郎君は、<var>N</var> 羽のうさぎたちをいくつかのグループへ分けようとしています。
このとき、各うさぎはちょうど <var>1</var> つのグループに属さなければなりません。
グループ分けの結果、各 <var>i, j</var> (<var>1 \leq i &lt; j \leq N</var>) について、うさぎ <var>i</var> と <var>j</var> が同じグループに属するならば、太郎君は <var>a_{i, j}</var> 点を得ます。</p>
<p>太郎君の総得点の最大値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 16</var></li>
<li><var>|a_{i, j}| \leq 10^9</var></li>
<li><var>a_{i, i} = 0</var></li>
<li><var>a_{i, j} = a_{j, i}</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>a_{1, 1}</var> <var>\ldots</var> <var>a_{1, N}</var>
<var>:</var>
<var>a_{N, 1}</var> <var>\ldots</var> <var>a_{N, N}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>太郎君の総得点の最大値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3
0 10 20
10 0 -100
20 -100 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>20
</pre>

<p><var>\{1, 3\}, \{2\}</var> とグループ分けすればよいです。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>2
0 -10
-10 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>0
</pre>

<p><var>\{1\}, \{2\}</var> とグループ分けすればよいです。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>4
0 1000000000 1000000000 1000000000
1000000000 0 1000000000 1000000000
1000000000 1000000000 0 -1
1000000000 1000000000 -1 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>4999999999
</pre>

<p><var>\{1, 2, 3, 4\}</var> とグループ分けすればよいです。
答えは 32-bit 整数型に収まらない場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>16
0 5 -4 -5 -8 -4 7 2 -4 0 7 0 2 -3 7 7
5 0 8 -9 3 5 2 -7 2 -7 0 -1 -4 1 -1 9
-4 8 0 -9 8 9 3 1 4 9 6 6 -6 1 8 9
-5 -9 -9 0 -7 6 4 -1 9 -3 -5 0 1 2 -4 1
-8 3 8 -7 0 -5 -9 9 1 -9 -6 -3 -8 3 4 3
-4 5 9 6 -5 0 -6 1 -2 2 0 -5 -2 3 1 2
7 2 3 4 -9 -6 0 -2 -2 -9 -3 9 -2 9 2 -5
2 -7 1 -1 9 1 -2 0 -6 0 -6 6 4 -1 -7 8
-4 2 4 9 1 -2 -2 -6 0 8 -6 -2 -4 8 7 7
0 -7 9 -3 -9 2 -9 0 8 0 0 1 -3 3 -6 -6
7 0 6 -5 -6 0 -3 -6 -6 0 0 5 7 -1 -5 3
0 -1 6 0 -3 -5 9 6 -2 1 5 0 -2 7 -8 0
2 -4 -6 1 -8 -2 -2 4 -4 -3 7 -2 0 -9 7 1
-3 1 1 2 3 3 9 -1 8 3 -1 7 -9 0 -6 -8
7 -1 8 -4 4 1 2 -7 7 -6 -5 -8 7 -6 0 -9
7 9 9 1 3 2 -5 8 7 -6 3 0 1 -8 -9 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>132
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> rabbits, numbered <var>1, 2, \ldots, N</var>.</p>
<p>For each <var>i, j</var> (<var>1 \leq i, j \leq N</var>), the compatibility of Rabbit <var>i</var> and <var>j</var> is described by an integer <var>a_{i, j}</var>.
Here, <var>a_{i, i} = 0</var> for each <var>i</var> (<var>1 \leq i \leq N</var>), and <var>a_{i, j} = a_{j, i}</var> for each <var>i</var> and <var>j</var> (<var>1 \leq i, j \leq N</var>).</p>
<p>Taro is dividing the <var>N</var> rabbits into some number of groups.
Here, each rabbit must belong to exactly one group.
After grouping, for each <var>i</var> and <var>j</var> (<var>1 \leq i &lt; j \leq N</var>), Taro earns <var>a_{i, j}</var> points if Rabbit <var>i</var> and <var>j</var> belong to the same group.</p>
<p>Find Taro's maximum possible total score.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 16</var></li>
<li><var>|a_{i, j}| \leq 10^9</var></li>
<li><var>a_{i, i} = 0</var></li>
<li><var>a_{i, j} = a_{j, i}</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>a_{1, 1}</var> <var>\ldots</var> <var>a_{1, N}</var>
<var>:</var>
<var>a_{N, 1}</var> <var>\ldots</var> <var>a_{N, N}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print Taro's maximum possible total score.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
0 10 20
10 0 -100
20 -100 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>20
</pre>

<p>The rabbits should be divided as <var>\{1, 3\}, \{2\}</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>2
0 -10
-10 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
</pre>

<p>The rabbits should be divided as <var>\{1\}, \{2\}</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>4
0 1000000000 1000000000 1000000000
1000000000 0 1000000000 1000000000
1000000000 1000000000 0 -1
1000000000 1000000000 -1 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>4999999999
</pre>

<p>The rabbits should be divided as <var>\{1, 2, 3, 4\}</var>.
Note that the answer may not fit into a 32-bit integer type.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>16
0 5 -4 -5 -8 -4 7 2 -4 0 7 0 2 -3 7 7
5 0 8 -9 3 5 2 -7 2 -7 0 -1 -4 1 -1 9
-4 8 0 -9 8 9 3 1 4 9 6 6 -6 1 8 9
-5 -9 -9 0 -7 6 4 -1 9 -3 -5 0 1 2 -4 1
-8 3 8 -7 0 -5 -9 9 1 -9 -6 -3 -8 3 4 3
-4 5 9 6 -5 0 -6 1 -2 2 0 -5 -2 3 1 2
7 2 3 4 -9 -6 0 -2 -2 -9 -3 9 -2 9 2 -5
2 -7 1 -1 9 1 -2 0 -6 0 -6 6 4 -1 -7 8
-4 2 4 9 1 -2 -2 -6 0 8 -6 -2 -4 8 7 7
0 -7 9 -3 -9 2 -9 0 8 0 0 1 -3 3 -6 -6
7 0 6 -5 -6 0 -3 -6 -6 0 0 5 7 -1 -5 3
0 -1 6 0 -3 -5 9 6 -2 1 5 0 -2 7 -8 0
2 -4 -6 1 -8 -2 -2 4 -4 -3 7 -2 0 -9 7 1
-3 1 1 2 3 3 9 -1 8 3 -1 7 -9 0 -6 -8
7 -1 8 -4 4 1 2 -7 7 -6 -5 -8 7 -6 0 -9
7 9 9 1 3 2 -5 8 7 -6 3 0 1 -8 -9 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>132
</pre></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">V - Subtree</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 頂点の木があります。
頂点には <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N - 1</var>) について、<var>i</var> 番目の辺は頂点 <var>x_i</var> と <var>y_i</var> を結んでいます。</p>
<p>太郎君は、各頂点を白または黒で塗ることにしました。
このとき、どの黒い頂点からどの黒い頂点へも、黒い頂点のみを辿って到達できるようにします。</p>
<p>正整数 <var>M</var> が与えられます。
各 <var>v</var> (<var>1 \leq v \leq N</var>) について、次の質問に答えてください。</p>
<ul>
<li>頂点 <var>v</var> が黒であるような頂点の色の組合せは何通りか？ <var>M</var> で割った余りを求めよ。</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 10^5</var></li>
<li><var>2 \leq M \leq 10^9</var></li>
<li><var>1 \leq x_i, y_i \leq N</var></li>
<li>与えられるグラフは木である。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>M</var>
<var>x_1</var> <var>y_1</var>
<var>x_2</var> <var>y_2</var>
<var>:</var>
<var>x_{N - 1}</var> <var>y_{N - 1}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p><var>N</var> 行出力せよ。
<var>v</var> (<var>1 \leq v \leq N</var>) 行目には、次の質問に対する答えを出力せよ。</p>
<ul>
<li>頂点 <var>v</var> が黒であるような頂点の色の組合せは何通りか？ <var>M</var> で割った余りを求めよ。</li>
</ul>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3 100
1 2
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>3
4
3
</pre>

<p>頂点の色の組合せは次図の <var>7</var> 通りです。
このうち、頂点 <var>1</var> が黒であるようなものは <var>3</var> 通り、頂点 <var>2</var> が黒であるようなものは <var>4</var> 通り、頂点 <var>3</var> が黒であるようなものは <var>3</var> 通りです。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/subtree_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>4 100
1 2
1 3
1 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>8
5
5
5
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>1 100
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>1
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>10 2
8 5
10 8
6 5
1 5
4 8
2 10
3 6
9 2
1 7
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>0
0
1
1
1
0
1
0
1
1
</pre>

<p>答えを <var>M</var> で割った余りを出力することを忘れずに。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a tree with <var>N</var> vertices, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N - 1</var>), the <var>i</var>-th edge connects Vertex <var>x_i</var> and <var>y_i</var>.</p>
<p>Taro has decided to paint each vertex in white or black, so that any black vertex can be reached from any other black vertex by passing through only black vertices.</p>
<p>You are given a positive integer <var>M</var>.
For each <var>v</var> (<var>1 \leq v \leq N</var>), answer the following question:</p>
<ul>
<li>Assuming that Vertex <var>v</var> has to be black, find the number of ways in which the vertices can be painted, modulo <var>M</var>.</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 10^5</var></li>
<li><var>2 \leq M \leq 10^9</var></li>
<li><var>1 \leq x_i, y_i \leq N</var></li>
<li>The given graph is a tree.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>M</var>
<var>x_1</var> <var>y_1</var>
<var>x_2</var> <var>y_2</var>
<var>:</var>
<var>x_{N - 1}</var> <var>y_{N - 1}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print <var>N</var> lines.
The <var>v</var>-th (<var>1 \leq v \leq N</var>) line should contain the answer to the following question:</p>
<ul>
<li>Assuming that Vertex <var>v</var> has to be black, find the number of ways in which the vertices can be painted, modulo <var>M</var>.</li>
</ul>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 100
1 2
2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>3
4
3
</pre>

<p>There are seven ways to paint the vertices, as shown in the figure below.
Among them, there are three ways such that Vertex <var>1</var> is black, four ways such that Vertex <var>2</var> is black and three ways such that Vertex <var>3</var> is black.</p>
<p><img alt="" src="https://img.atcoder.jp/dp/subtree_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>4 100
1 2
1 3
1 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>8
5
5
5
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>1 100
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>1
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>10 2
8 5
10 8
6 5
1 5
4 8
2 10
3 6
9 2
1 7
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>0
0
1
1
1
0
1
0
1
1
</pre>

<p>Be sure to print the answers modulo <var>M</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">W - Intervals</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>長さ <var>N</var> の <code>0</code> と <code>1</code> からなる文字列を考えます。
この文字列のスコアを次のように計算します。</p>
<ul>
<li>各 <var>i</var> (<var>1 \leq i \leq M</var>) について、<var>l_i</var> 文字目から <var>r_i</var> 文字目までに <code>1</code> がひとつ以上含まれるならば、スコアに <var>a_i</var> を加算する。</li>
</ul>
<p>文字列のスコアの最大値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 2 × 10^5</var></li>
<li><var>1 \leq M \leq 2 × 10^5</var></li>
<li><var>1 \leq l_i \leq r_i \leq N</var></li>
<li><var>|a_i| \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>M</var>
<var>l_1</var> <var>r_1</var> <var>a_1</var>
<var>l_2</var> <var>r_2</var> <var>a_2</var>
<var>:</var>
<var>l_M</var> <var>r_M</var> <var>a_M</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>文字列のスコアの最大値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>5 3
1 3 10
2 4 -10
3 5 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>20
</pre>

<p><code>10001</code> のスコアは <var>a_1 + a_3 = 10 + 10 = 20</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>3 4
1 3 100
1 1 -10
2 2 -20
3 3 -30
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>90
</pre>

<p><code>100</code> のスコアは <var>a_1 + a_2 = 100 + (-10) = 90</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>1 1
1 1 -10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>0
</pre>

<p><code>0</code> のスコアは <var>0</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>1 5
1 1 1000000000
1 1 1000000000
1 1 1000000000
1 1 1000000000
1 1 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>5000000000
</pre>

<p>答えは 32-bit 整数型に収まらない場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 5</h3><pre>6 8
5 5 3
1 1 10
1 6 -8
3 6 5
3 4 9
5 5 -2
1 3 -6
4 6 -7
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 5</h3><pre>10
</pre>

<p>例えば、<code>101000</code> のスコアは <var>a_2 + a_3 + a_4 + a_5 + a_7 = 10 + (-8) + 5 + 9 + (-6) = 10</var> となります。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>Consider a string of length <var>N</var> consisting of <code>0</code> and <code>1</code>.
The score for the string is calculated as follows:</p>
<ul>
<li>For each <var>i</var> (<var>1 \leq i \leq M</var>), <var>a_i</var> is added to the score if the string contains <code>1</code> at least once between the <var>l_i</var>-th and <var>r_i</var>-th characters (inclusive).</li>
</ul>
<p>Find the maximum possible score of a string.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 2 × 10^5</var></li>
<li><var>1 \leq M \leq 2 × 10^5</var></li>
<li><var>1 \leq l_i \leq r_i \leq N</var></li>
<li><var>|a_i| \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>M</var>
<var>l_1</var> <var>r_1</var> <var>a_1</var>
<var>l_2</var> <var>r_2</var> <var>a_2</var>
<var>:</var>
<var>l_M</var> <var>r_M</var> <var>a_M</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the maximum possible score of a string.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>5 3
1 3 10
2 4 -10
3 5 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>20
</pre>

<p>The score for <code>10001</code> is <var>a_1 + a_3 = 10 + 10 = 20</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3 4
1 3 100
1 1 -10
2 2 -20
3 3 -30
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>90
</pre>

<p>The score for <code>100</code> is <var>a_1 + a_2 = 100 + (-10) = 90</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>1 1
1 1 -10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0
</pre>

<p>The score for <code>0</code> is <var>0</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>1 5
1 1 1000000000
1 1 1000000000
1 1 1000000000
1 1 1000000000
1 1 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>5000000000
</pre>

<p>The answer may not fit into a 32-bit integer type.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 5</h3><pre>6 8
5 5 3
1 1 10
1 6 -8
3 6 5
3 4 9
5 5 -2
1 3 -6
4 6 -7
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 5</h3><pre>10
</pre>

<p>For example, the score for <code>101000</code> is <var>a_2 + a_3 + a_4 + a_5 + a_7 = 10 + (-8) + 5 + 9 + (-6) = 10</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">X - Tower</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 個のブロックがあります。
ブロックには <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、ブロック <var>i</var> の重さは <var>w_i</var> で、丈夫さは <var>s_i</var> で、価値は <var>v_i</var> です。</p>
<p>太郎君は、<var>N</var> 個のブロックのうち何個かを選び、それらを任意の順序で一列に積み重ね、塔を作ることにしました。
このとき、塔は次の条件を満たさなければなりません。</p>
<ul>
<li>塔に含まれる各ブロック <var>i</var> について、ブロック <var>i</var> より上に積まれたブロックの重さの総和は <var>s_i</var> 以下である。</li>
</ul>
<p>塔に含まれるブロックの価値の総和の最大値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>1 \leq N \leq 10^3</var></li>
<li><var>1 \leq w_i, s_i \leq 10^4</var></li>
<li><var>1 \leq v_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>w_1</var> <var>s_1</var> <var>v_1</var>
<var>w_2</var> <var>s_2</var> <var>v_2</var>
<var>:</var>
<var>w_N</var> <var>s_N</var> <var>v_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>塔に含まれるブロックの価値の総和の最大値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3
2 2 20
2 1 30
3 1 40
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>50
</pre>

<p>上から順にブロック <var>2, 1</var> と積み重ねると、この塔は条件を満たします。
塔に含まれるブロックの価値の総和は <var>30 + 20 = 50</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>4
1 2 10
3 1 10
2 4 10
1 6 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>40
</pre>

<p>上から順にブロック <var>1, 2, 3, 4</var> と積み重ねればよいです。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>5
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>5000000000
</pre>

<p>答えは 32-bit 整数型に収まらない場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>8
9 5 7
6 2 7
5 7 3
7 8 8
1 9 6
3 3 3
4 1 7
4 5 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>22
</pre>

<p>例えば、上から順にブロック <var>5, 6, 8, 4</var> と積み重ねればよいです。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> blocks, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N</var>), Block <var>i</var> has a weight of <var>w_i</var>, a solidness of <var>s_i</var> and a value of <var>v_i</var>.</p>
<p>Taro has decided to build a tower by choosing some of the <var>N</var> blocks and stacking them vertically in some order.
Here, the tower must satisfy the following condition:</p>
<ul>
<li>For each Block <var>i</var> contained in the tower, the sum of the weights of the blocks stacked above it is not greater than <var>s_i</var>.</li>
</ul>
<p>Find the maximum possible sum of the values of the blocks contained in the tower.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>1 \leq N \leq 10^3</var></li>
<li><var>1 \leq w_i, s_i \leq 10^4</var></li>
<li><var>1 \leq v_i \leq 10^9</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>w_1</var> <var>s_1</var> <var>v_1</var>
<var>w_2</var> <var>s_2</var> <var>v_2</var>
<var>:</var>
<var>w_N</var> <var>s_N</var> <var>v_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the maximum possible sum of the values of the blocks contained in the tower.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
2 2 20
2 1 30
3 1 40
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>50
</pre>

<p>If Blocks <var>2, 1</var> are stacked in this order from top to bottom, this tower will satisfy the condition, with the total value of <var>30 + 20 = 50</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>4
1 2 10
3 1 10
2 4 10
1 6 10
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>40
</pre>

<p>Blocks <var>1, 2, 3, 4</var> should be stacked in this order from top to bottom.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000
1 10000 1000000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>5000000000
</pre>

<p>The answer may not fit into a 32-bit integer type.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>8
9 5 7
6 2 7
5 7 3
7 8 8
1 9 6
3 3 3
4 1 7
4 5 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>22
</pre>

<p>We should, for example, stack Blocks <var>5, 6, 8, 4</var> in this order from top to bottom.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">Y - Grid 2</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>縦 <var>H</var> 行、横 <var>W</var> 列のグリッドがあります。
上から <var>i</var> 行目、左から <var>j</var> 列目のマスを <var>(i, j)</var> で表します。</p>
<p>グリッドのうち、<var>N</var> 個のマス <var>(r_1, c_1), (r_2, c_2), \ldots, (r_N, c_N)</var> は壁のマスであり、それら以外のマスはすべて空マスです。 
マス <var>(1, 1)</var> および <var>(H, W)</var> は空マスであることが保証されています。</p>
<p>太郎君は、マス <var>(1, 1)</var> から出発し、右または下に隣り合う空マスへの移動を繰り返すことで、マス <var>(H, W)</var> まで辿り着こうとしています。</p>
<p>マス <var>(1, 1)</var> から <var>(H, W)</var> までの太郎君の経路は何通りでしょうか？
<var>10^9 + 7</var> で割った余りを求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>2 \leq H, W \leq 10^5</var></li>
<li><var>1 \leq N \leq 3000</var></li>
<li><var>1 \leq r_i \leq H</var></li>
<li><var>1 \leq c_i \leq W</var></li>
<li>マス <var>(r_i, c_i)</var> はすべて相異なる。</li>
<li>マス <var>(1, 1)</var> および <var>(H, W)</var> は空マスである。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>H</var> <var>W</var> <var>N</var>
<var>r_1</var> <var>c_1</var>
<var>r_2</var> <var>c_2</var>
<var>:</var>
<var>r_N</var> <var>c_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>マス <var>(1, 1)</var> から <var>(H, W)</var> までの太郎君の経路は何通りか？
<var>10^9 + 7</var> で割った余りを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>3 4 2
2 2
1 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>3
</pre>

<p>経路は次図の <var>3</var> 通りです。</p>
<p><img alt="" src="https://img.atcoder.jp/dp/grid_1_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>5 2 2
2 1
4 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>0
</pre>

<p>経路が存在しない場合もあります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>5 5 4
3 1
3 5
1 3
5 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>24
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 4</h3><pre>100000 100000 1
50000 50000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>123445622
</pre>

<p>答えを <var>10^9 + 7</var> で割った余りを出力することを忘れずに。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There is a grid with <var>H</var> horizontal rows and <var>W</var> vertical columns.
Let <var>(i, j)</var> denote the square at the <var>i</var>-th row from the top and the <var>j</var>-th column from the left.</p>
<p>In the grid, <var>N</var> Squares <var>(r_1, c_1), (r_2, c_2), \ldots, (r_N, c_N)</var> are wall squares, and the others are all empty squares.
It is guaranteed that Squares <var>(1, 1)</var> and <var>(H, W)</var> are empty squares.</p>
<p>Taro will start from Square <var>(1, 1)</var> and reach <var>(H, W)</var> by repeatedly moving right or down to an adjacent empty square.</p>
<p>Find the number of Taro's paths from Square <var>(1, 1)</var> to <var>(H, W)</var>, modulo <var>10^9 + 7</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>2 \leq H, W \leq 10^5</var></li>
<li><var>1 \leq N \leq 3000</var></li>
<li><var>1 \leq r_i \leq H</var></li>
<li><var>1 \leq c_i \leq W</var></li>
<li>Squares <var>(r_i, c_i)</var> are all distinct.</li>
<li>Squares <var>(1, 1)</var> and <var>(H, W)</var> are empty squares.</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>H</var> <var>W</var> <var>N</var>
<var>r_1</var> <var>c_1</var>
<var>r_2</var> <var>c_2</var>
<var>:</var>
<var>r_N</var> <var>c_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the number of Taro's paths from Square <var>(1, 1)</var> to <var>(H, W)</var>, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 4 2
2 2
1 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>3
</pre>

<p>There are three paths as follows:</p>
<p><img alt="" src="https://img.atcoder.jp/dp/grid_1_0_muffet.png" /></p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5 2 2
2 1
4 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
</pre>

<p>There may be no paths.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5 5 4
3 1
3 5
1 3
5 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>24
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>100000 100000 1
50000 50000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>123445622
</pre>

<p>Be sure to print the count modulo <var>10^9 + 7</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
		<div class="next-page col-sm-12"></div>
		<div class="col-sm-12">
			<span class="h2">Z - Frog 3</span>
			<hr />
			<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>

			<div id="task-statement">
				<span class="lang">
<span class="lang-ja">
<p>配点 : <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 個の足場があります。
足場には <var>1, 2, \ldots, N</var> と番号が振られています。
各 <var>i</var> (<var>1 \leq i \leq N</var>) について、足場 <var>i</var> の高さは <var>h_i</var> です。
ここで、<var>h_1 &lt; h_2 &lt; \cdots &lt; h_N</var> です。</p>
<p>最初、足場 <var>1</var> にカエルがいます。
カエルは次の行動を何回か繰り返し、足場 <var>N</var> まで辿り着こうとしています。</p>
<ul>
<li>足場 <var>i</var> にいるとき、足場 <var>i + 1, i + 2, \ldots, N</var> のどれかへジャンプする。 このとき、ジャンプ先の足場を <var>j</var> とすると、コスト <var>(h_j - h_i)^2 + C</var> を支払う。</li>
</ul>
<p>カエルが足場 <var>N</var> に辿り着くまでに支払うコストの総和の最小値を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力はすべて整数である。</li>
<li><var>2 \leq N \leq 2 \times 10^5</var></li>
<li><var>1 \leq C \leq 10^{12}</var></li>
<li><var>1 \leq h_1 &lt; h_2 &lt; \cdots &lt; h_N \leq 10^6</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>C</var>
<var>h_1</var> <var>h_2</var> <var>\ldots</var> <var>h_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>カエルが支払うコストの総和の最小値を出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre>5 6
1 2 3 4 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>20
</pre>

<p>足場 <var>1</var> → <var>3</var> → <var>5</var> と移動すると、コストの総和は <var>((3 - 1)^2 + 6) + ((5 - 3)^2 + 6) = 20</var> となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 2</h3><pre>2 1000000000000
500000 1000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>1250000000000
</pre>

<p>答えは 32-bit 整数型に収まらない場合があります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 3</h3><pre>8 5
1 3 4 5 10 11 12 13
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>62
</pre>

<p>足場 <var>1</var> → <var>2</var> → <var>4</var> → <var>5</var> → <var>8</var> と移動すると、コストの総和は <var>((3 - 1)^2 + 5) + ((5 - 3)^2 + 5) + ((10 - 5)^2 + 5) + ((13 - 10)^2 + 5) = 62</var> となります。</p></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> stones, numbered <var>1, 2, \ldots, N</var>.
For each <var>i</var> (<var>1 \leq i \leq N</var>), the height of Stone <var>i</var> is <var>h_i</var>.
Here, <var>h_1 &lt; h_2 &lt; \cdots &lt; h_N</var> holds.</p>
<p>There is a frog who is initially on Stone <var>1</var>.
He will repeat the following action some number of times to reach Stone <var>N</var>:</p>
<ul>
<li>If the frog is currently on Stone <var>i</var>, jump to one of the following: Stone <var>i + 1, i + 2, \ldots, N</var>. Here, a cost of <var>(h_j - h_i)^2 + C</var> is incurred, where <var>j</var> is the stone to land on.</li>
</ul>
<p>Find the minimum possible total cost incurred before the frog reaches Stone <var>N</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li>All values in input are integers.</li>
<li><var>2 \leq N \leq 2 \times 10^5</var></li>
<li><var>1 \leq C \leq 10^{12}</var></li>
<li><var>1 \leq h_1 &lt; h_2 &lt; \cdots &lt; h_N \leq 10^6</var></li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>C</var>
<var>h_1</var> <var>h_2</var> <var>\ldots</var> <var>h_N</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>Print the minimum possible total cost incurred.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>5 6
1 2 3 4 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>20
</pre>

<p>If we follow the path <var>1</var> → <var>3</var> → <var>5</var>, the total cost incurred would be <var>((3 - 1)^2 + 6) + ((5 - 3)^2 + 6) = 20</var>.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>2 1000000000000
500000 1000000
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>1250000000000
</pre>

<p>The answer may not fit into a 32-bit integer type.</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>8 5
1 3 4 5 10 11 12 13
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>62
</pre>

<p>If we follow the path <var>1</var> → <var>2</var> → <var>4</var> → <var>5</var> → <var>8</var>, the total cost incurred would be <var>((3 - 1)^2 + 5) + ((5 - 3)^2 + 5) + ((10 - 5)^2 + 5) + ((13 - 10)^2 + 5) = 62</var>.</p></section>
</div>
</span>
</span>

			</div>

			
		</div>
	
</div>




	</div> 
</div> 
</body>
</html>
